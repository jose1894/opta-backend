import{u as te,ak as se,ae as le,f as Q,g as h,r as f,o as d,h as U,i,a as u,b as l,z as P,t as c,F as L,k as z,d as O,p as o,al as oe,S as j,am as ne,s as ie,x as G,c as k,y as ce,U as re,A as ue,m as H,B as me,ap as de,aq as ge}from"./index.bf3eb1d4.js";import{a as D,_ as W}from"./BaseButton.1e584900.js";import{_ as fe}from"./NotificationBar.3e298193.js";import{C as pe}from"./CardBoxComponentEmpty.6d65eafd.js";import{_ as J}from"./SectionTitleLineWithButton.09e8c280.js";import{C as K}from"./CardBoxModal.7e1dd63f.js";import{a as F}from"./allies.service.ab47b687.js";import{_ as he}from"./FormCheckRadioGroup.7cea6fbc.js";import{_ as ve}from"./FormField.ce92b931.js";import{B as $e}from"./Breadcrumb.2cc5bf09.js";import"./FormCheckRadio.0929eb1e.js";const be=l("th",null,null,-1),ke=["onClick"],_e=["data-label"],Ce=["data-label"],ye=["data-label"],we=["data-label"],Pe={class:"before:hidden lg:w-1 whitespace-nowrap"},De={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Ve={__name:"AllyTable.view",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(V,{emit:b}){const{t:r}=te(),g=se(),S=le(),m=Q(),_=h(()=>m.allies.aliados),T=h(()=>m.allies.total),C=f(!1),y=f(!1),I=h(()=>m.allies.perPage),p=h(()=>m.allies.page);f([]);const v=f([]),E=h(()=>_.value),s=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=f(!1),$=e=>{n.value=!n.value,b("sort",e,n.value)},w=h(()=>Math.ceil(T.value/I.value)),B=h(()=>+p.value),A=h(()=>{const e=[];for(let a=0;a<w.value;a++)e.push(a);return e}),M=e=>{b("changePage",e)},N=e=>{S.push({name:"AlliesUpdate",params:{id:e}})},X=e=>v.value=e,R=()=>{const{nombre:e}=v.value;return e},Y=r("message.ally.deleted.success"),Z=async()=>{x().then(()=>{g.success(Y),b("changePage",p.value)}).catch(e=>{var a;g.error(`${r("message.ally.deleted.error")} ${(a=e==null?void 0:e.response)==null?void 0:a.data.msg}`)})},x=()=>{const{_id:e}=v.value;return F.delete(e)},ee=()=>{const{_id:e}=v.value;F.restore(e).then(()=>{g.success(r("message.ally.restore.success")),b("changePage",p.value)}).catch(a=>{var t;g.error(`${r("message.ally.restore.error")} ${(t=a==null?void 0:a.response)==null?void 0:t.data.msg}`)})};return(e,a)=>(d(),U(L,null,[i(K,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=t=>y.value=t),title:e.$t("message.pleaseConfirm"),button:"danger",onConfirm:Z,"has-cancel":""},{default:u(()=>[l("strong",null,[P(c(e.$t("message.ally.deleted.question"))+" ",1),l("b",null,c(R()),1)]),P(" ? ")]),_:1},8,["modelValue","title"]),i(K,{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=t=>C.value=t),title:e.$t("message.pleaseConfirm"),onConfirm:ee},{default:u(()=>[l("strong",null,[P(c(e.$t("message.ally.restore.question"))+" ",1),l("b",null,c(R()),1)]),P(" ? ")]),_:1},8,["modelValue","title"]),l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:a[2]||(a[2]=t=>$("codigo"))},c(e.$t("message.ally.code")),1),l("th",{onClick:a[3]||(a[3]=t=>$("nombre"))},c(e.$t("message.ally.name")),1),l("th",{onClick:a[4]||(a[4]=t=>$("idFiscal"))},c(e.$t("message.ally.id")),1),l("th",{onClick:a[5]||(a[5]=t=>$("estado"))},c(e.$t("message.ally.status")),1),be])]),l("tbody",null,[(d(!0),U(L,null,z(o(E),(t,ae)=>(d(),U("tr",{key:t._id,onClick:q=>X(t)},[l("td",{"data-label":e.$t("message.ally.code")},c(t.codigo),9,_e),l("td",{"data-label":e.$t("message.ally.name")},c(t.nombre),9,Ce),l("td",{"data-label":e.$t("message.ally.id")},c(t.iDFiscal),9,ye),l("td",{"data-label":e.$t("message.ally.status")},c(e.$t(`message.ally.statuses.${s(t.estado)}`)),9,we),l("td",Pe,[i(G,{type:"justify-start lg:justify-end","no-wrap":""},{default:u(()=>[O(i(D,{color:"success",icon:o(oe),messageTooltip:o(r)("message.restore"),small:"",onClick:a[6]||(a[6]=q=>C.value=!0)},null,8,["icon","messageTooltip"]),[[j,V.checkDelete&&t.estado===2]]),O(i(D,{color:"info",icon:o(ne),messageTooltip:o(r)("message.edit"),small:"",onClick:q=>N(t._id)},null,8,["icon","messageTooltip","onClick"]),[[j,!V.checkDelete&&t.estado!==2]]),O(i(D,{color:"danger",icon:o(ie),messageTooltip:o(r)("message.delete"),small:"",onClick:a[7]||(a[7]=q=>y.value=!0)},null,8,["icon","messageTooltip"]),[[j,!V.checkDelete&&t.estado!==2]])]),_:2},1024)])],8,ke))),128))])]),l("div",De,[i(ce,null,{default:u(()=>[i(G,null,{default:u(()=>[(d(!0),U(L,null,z(o(A),t=>(d(),k(D,{key:t,active:t===o(p)-1,label:t+1,color:t===o(p)?"lightDark":"whiteDark",small:"",onClick:ae=>M(t+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),l("small",null,"Page "+c(o(B))+" of "+c(o(w)),1)]),_:1})])],64))}},Le={__name:"IndexView",setup(V){const b=f([{name:"Inicio"}]),r=Q(),g=f(1),S=f(10),m=re({switch:[]}),_=s=>{F.index(s).then(n=>{r.allies=n,g.value=n.page,S.value=n.perPage})};_({page:g.value});const T=f(!1),C=()=>{v(g.value),T.value=m.switch.length!==0},y=s=>{v({page:s})},I=(s,n)=>{E({sortBy:s,sortDesc:n})},p=s=>{F.getDelete(s).then(n=>{r.allies=n,g.value=n.page,S.value=n.perPage})},v=s=>{m.switch.length===0?_(s):p(s)},E=s=>{m.switch.length===0?_(s):p(s)};return(s,n)=>(d(),k(ue,null,{default:u(()=>[i(me,null,{default:u(()=>{var $,w,B,A,M;return[i(J,{icon:o(de),title:s.$t("message.ally.allies")},{default:u(()=>[i(D,{to:{name:"AlliesCreate"},icon:o(ge),label:s.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),i($e,{items:b.value},null,8,["items"]),i(ve,{label:""},{default:u(()=>[i(he,{modelValue:m.switch,"onUpdate:modelValue":n[0]||(n[0]=N=>m.switch=N),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:C},null,8,["modelValue"])]),_:1}),($=o(r))!=null&&$.allies?H("",!0):(d(),k(J,{key:0,icon:s.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(w=o(r))!=null&&w.allies?H("",!0):(d(),k(fe,{key:1,color:"danger",icon:s.mdiTableOff},{default:u(()=>[l("b",null,c(s.$t("message.empty_table"))+".",1),P(" When there's nothing to show ")]),_:1},8,["icon"])),(M=(A=(B=o(r))==null?void 0:B.allies)==null?void 0:A.aliados)!=null&&M.length?(d(),k(W,{key:2,class:"mb-6","has-table":""},{default:u(()=>[i(Ve,{checkDelete:T.value,onChangePage:y,onSort:I},null,8,["checkDelete"])]),_:1})):(d(),k(W,{key:3},{default:u(()=>[i(pe)]),_:1}))]}),_:1})]),_:1}))}};export{Le as default};
