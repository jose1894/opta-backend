import{ag as te,ah as ae,aa as ne,S as z,I as h,y as p,o as m,r as B,a as c,w as u,j as n,f as x,E as r,$ as R,K as q,L as G,M as A,d as y,u as l,ai as le,aj as F,ak as oe,al as ce,A as H,c as b,T as ie,x as ue,_ as re,b as K,ao as de,B as me,Q,e as ge,g as W,i as pe,ap as fe,aq as he}from"./index.e27aaed2.js";import{C as ve}from"./CardBoxComponentEmpty.8b08f16b.js";import{e as M}from"./expense.service.e1ec2c32.js";import{_ as _e}from"./FormCheckRadioGroup.84cb26fc.js";import"./FormCheckRadio.44135d25.js";const $e=n("th",null,null,-1),be=["onClick"],ke=["data-label"],Ce=["data-label"],Pe={class:"before:hidden lg:w-1 whitespace-nowrap"},we={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},xe={__name:"ExpenseTableView",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(D,{emit:_}){const{t:i}=te(),g=ae(),V=ne(),d=z(),k=h(()=>d.expense.gastos),I=h(()=>d.expense.total),C=p(!1),$=p(!1),U=h(()=>d.expense.perPage),f=h(()=>d.expense.page),v=p([]);p([]);const N=h(()=>k.value),a=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],o=p(!1),P=e=>{o.value=!o.value,_("sort",e,o.value)},w=h(()=>Math.ceil(I.value/U.value)),T=h(()=>+f.value),E=h(()=>{const e=[];for(let s=0;s<w.value;s++)e.push(s);return e}),S=e=>{_("changePage",e)},j=e=>{V.push({name:"ExpenseUpdate",params:{id:e}})},J=e=>v.value=e,O=()=>{const{concepto:e}=v.value;return e},X=i("message.expense.deleted.success"),Y=async()=>{Z().then(()=>{g.success(X),_("changePage",f.value)}).catch(e=>{var s;g.error(`${i("message.expense.deleted.error")} ${(s=e==null?void 0:e.response)==null?void 0:s.data.msg}`)})},Z=()=>{const{_id:e}=v.value;return M.delete(e)},ee=()=>{const{_id:e}=v.value;M.restore(e).then(()=>{g.success(i("message.expense.restore.success")),_("changePage",f.value)}).catch(s=>{var t;g.error(`${i("message.expense.restore.error")} ${(t=s==null?void 0:s.response)==null?void 0:t.data.msg}`)})};return(e,s)=>(m(),B(q,null,[c(R,{modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=t=>$.value=t),title:"Please confirm",button:"danger",onConfirm:Y,"has-cancel":""},{default:u(()=>[n("strong",null,[x(r(e.$t("message.expense.deleted.question"))+" ",1),n("b",null,r(O()),1)]),x(" ? ")]),_:1},8,["modelValue"]),c(R,{modelValue:C.value,"onUpdate:modelValue":s[1]||(s[1]=t=>C.value=t),title:"Please confirm",onConfirm:ee},{default:u(()=>[n("strong",null,[x(r(e.$t("message.expense.restore.question"))+" ",1),n("b",null,r(O()),1)]),x(" ? ")]),_:1},8,["modelValue"]),n("table",null,[n("thead",null,[n("tr",null,[n("th",{onClick:s[2]||(s[2]=t=>P("concepto"))},r(e.$t("message.expense.concept")),1),n("th",{onClick:s[3]||(s[3]=t=>P("estado"))},r(e.$t("message.expense.status")),1),$e])]),n("tbody",null,[(m(!0),B(q,null,G(l(N),(t,se)=>(m(),B("tr",{key:t._id,onClick:L=>J(t)},[n("td",{"data-label":e.$t("message.expense.concept")},r(t.concepto),9,ke),n("td",{"data-label":e.$t("message.expense.status")},r(e.$t(`message.expense.statuses.${a(t.estado)}`)),9,Ce),n("td",Pe,[c(H,{type:"justify-start lg:justify-end","no-wrap":""},{default:u(()=>[A(c(y,{color:"success",icon:l(le),messageTooltip:l(i)("message.restore"),small:"",onClick:s[4]||(s[4]=L=>C.value=!0)},null,8,["icon","messageTooltip"]),[[F,D.checkDelete&&t.estado===2]]),A(c(y,{color:"info",icon:l(oe),messageTooltip:l(i)("message.edit"),small:"",onClick:L=>j(t._id)},null,8,["icon","messageTooltip","onClick"]),[[F,!D.checkDelete&&t.estado!==2]]),A(c(y,{color:"danger",icon:l(ce),messageTooltip:l(i)("message.delete"),small:"",onClick:s[5]||(s[5]=L=>$.value=!0)},null,8,["icon","messageTooltip"]),[[F,!D.checkDelete&&t.estado!==2]])]),_:2},1024)])],8,be))),128))])]),n("div",we,[c(ie,null,{default:u(()=>[c(H,null,{default:u(()=>[(m(!0),B(q,null,G(l(E),t=>(m(),b(y,{key:t,active:t===l(f)-1,label:t+1,color:t===l(f)?"lightDark":"whiteDark",small:"",onClick:se=>S(t+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),n("small",null,"Page "+r(l(T))+" of "+r(l(w)),1)]),_:1})])],64))}},Se={__name:"IndexView",setup(D){const _=p([{name:"Inicio"}]),i=z(),g=p(1),V=p(10),d=ue({switch:[]}),k=a=>{M.index(a).then(o=>{i.expense=o,g.value=o.page,V.value=o.perPage})};k({page:g.value});const I=a=>{v({page:a})},C=(a,o)=>{N({sortBy:a,sortDesc:o})},$=p(!1),U=()=>{v({page:g.value}),$.value=d.switch.length!==0},f=a=>{M.getDelete(a).then(o=>{i.expense=o,g.value=o.page,V.value=o.perPage})},v=a=>{d.switch.length===0?k({page:a}):f({page:a})},N=a=>{d.switch.length===0?k(a):f(a)};return(a,o)=>(m(),b(re,null,{default:u(()=>[c(pe,null,{default:u(()=>{var P,w,T,E,S;return[c(K,{icon:l(fe),title:a.$t("message.expense.expense")},{default:u(()=>[c(y,{to:{name:"ExpenseCreate"},icon:l(he),label:a.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),c(de,{items:_.value},null,8,["items"]),c(me,{label:""},{default:u(()=>[c(_e,{modelValue:d.switch,"onUpdate:modelValue":o[0]||(o[0]=j=>d.switch=j),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:U},null,8,["modelValue"])]),_:1}),(P=l(i))!=null&&P.expense?Q("",!0):(m(),b(K,{key:0,icon:a.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(w=l(i))!=null&&w.expense?Q("",!0):(m(),b(ge,{key:1,color:"danger",icon:a.mdiTableOff},{default:u(()=>[n("b",null,r(a.$t("message.empty_table"))+".",1),x(" When there's nothing to show ")]),_:1},8,["icon"])),(S=(E=(T=l(i))==null?void 0:T.expense)==null?void 0:E.gastos)!=null&&S.length?(m(),b(W,{key:2,class:"mb-6","has-table":""},{default:u(()=>[c(xe,{checkDelete:$.value,onChangePage:I,onSort:C},null,8,["checkDelete"])]),_:1})):(m(),b(W,{key:3},{default:u(()=>[c(ve)]),_:1}))]}),_:1})]),_:1}))}};export{Se as default};
