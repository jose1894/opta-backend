import{u as te,ak as ae,ae as oe,f as Q,g as p,r as b,o as d,h as U,i as m,a as c,b as o,z as y,t as r,F as L,k as z,d as O,p as l,al as le,S as j,am as ne,s as me,x as G,c as _,y as re,U as ie,A as ce,m as H,B as ue,ap as de,aq as ge}from"./index.cc1855cb.js";import{a as D,_ as W}from"./BaseButton.00025e8c.js";import{_ as be}from"./NotificationBar.63f4cacf.js";import{C as fe}from"./CardBoxComponentEmpty.47fc2389.js";import{_ as J}from"./SectionTitleLineWithButton.e8c4cbcb.js";import{C as K}from"./CardBoxModal.baa739ff.js";import{m as F}from"./member.service.4a696792.js";import{_ as pe}from"./FormField.c25f55fc.js";import{_ as he}from"./FormCheckRadioGroup.0473097c.js";import{B as ve}from"./Breadcrumb.0860d204.js";import"./FormCheckRadio.5511dc53.js";const $e=o("th",null,null,-1),ke=["onClick"],_e=["data-label"],Ce=["data-label"],we=["data-label"],Pe=["data-label"],ye={class:"before:hidden lg:w-1 whitespace-nowrap"},De={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Me={__name:"MemberTable.view",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(M,{emit:$}){const{t:i}=te(),g=ae(),V=oe(),u=Q(),C=p(()=>u.members.miembros),I=p(()=>u.members.total),w=b(!1),k=b(!1),E=p(()=>u.members.perPage),f=p(()=>u.members.page);b([]);const h=b([]),N=p(()=>C.value),a=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=b(!1),v=e=>{n.value=!n.value,$("sort",e,n.value)},P=p(()=>Math.ceil(I.value/E.value)),S=p(()=>+f.value),T=p(()=>{const e=[];for(let s=0;s<P.value;s++)e.push(s);return e}),B=e=>{$("changePage",e)},q=e=>{V.push({name:"MembershipsUpdate",params:{id:e}})},X=e=>h.value=e,R=()=>{const{nombre:e}=h.value;return e},Y=i("message.member.deleted.success"),Z=async()=>{x().then(()=>{g.success(Y),$("changePage",f.value)}).catch(e=>{var s;g.error(`${i("message.member.deleted.error")} ${(s=e==null?void 0:e.response)==null?void 0:s.data.msg}`)})},x=()=>{const{_id:e}=h.value;return F.delete(e)},ee=()=>{const{_id:e}=h.value;F.restore(e).then(()=>{g.success(i("message.member.restore.success")),$("changePage",f.value)}).catch(s=>{var t;g.error(`${i("message.member.restore.error")} ${(t=s==null?void 0:s.response)==null?void 0:t.data.msg}`)})};return(e,s)=>(d(),U(L,null,[m(K,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=t=>k.value=t),title:e.$t("message.pleaseConfirm"),button:"danger",onConfirm:Z,"has-cancel":""},{default:c(()=>[o("strong",null,[y(r(e.$t("message.member.deleted.question"))+" ",1),o("b",null,r(R()),1)]),y(" ? ")]),_:1},8,["modelValue","title"]),m(K,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=t=>w.value=t),title:e.$t("message.pleaseConfirm"),onConfirm:ee},{default:c(()=>[o("strong",null,[y(r(e.$t("message.member.restore.question"))+" ",1),o("b",null,r(R()),1)]),y(" ? ")]),_:1},8,["modelValue","title"]),o("table",null,[o("thead",null,[o("tr",null,[o("th",{onClick:s[2]||(s[2]=t=>v("codigo"))},r(e.$t("message.member.code")),1),o("th",{onClick:s[3]||(s[3]=t=>v("nombre"))},r(e.$t("message.member.name")),1),o("th",{onClick:s[4]||(s[4]=t=>v("iDFiscal"))},r(e.$t("message.member.id")),1),o("th",{onClick:s[5]||(s[5]=t=>v("estado"))},r(e.$t("message.member.status")),1),$e])]),o("tbody",null,[(d(!0),U(L,null,z(l(N),(t,se)=>(d(),U("tr",{key:t._id,onClick:A=>X(t)},[o("td",{"data-label":e.$t("message.member.code")},r(t.codigo),9,_e),o("td",{"data-label":e.$t("message.member.state")},r(t.nombre),9,Ce),o("td",{"data-label":e.$t("message.member.id")},r(t.iDFiscal),9,we),o("td",{"data-label":e.$t("message.member.status")},r(e.$t(`message.member.statuses.${a(t.estado)}`)),9,Pe),o("td",ye,[m(G,{type:"justify-start lg:justify-end","no-wrap":""},{default:c(()=>[O(m(D,{color:"success",icon:l(le),messageTooltip:l(i)("message.restore"),small:"",onClick:s[6]||(s[6]=A=>w.value=!0)},null,8,["icon","messageTooltip"]),[[j,M.checkDelete&&t.estado===2]]),O(m(D,{color:"info",icon:l(ne),messageTooltip:l(i)("message.edit"),small:"",onClick:A=>q(t._id)},null,8,["icon","messageTooltip","onClick"]),[[j,!M.checkDelete&&t.estado!==2]]),O(m(D,{color:"danger",icon:l(me),messageTooltip:l(i)("message.delete"),small:"",onClick:s[7]||(s[7]=A=>k.value=!0)},null,8,["icon","messageTooltip"]),[[j,!M.checkDelete&&t.estado!==2]])]),_:2},1024)])],8,ke))),128))])]),o("div",De,[m(re,null,{default:c(()=>[m(G,null,{default:c(()=>[(d(!0),U(L,null,z(l(T),t=>(d(),_(D,{key:t,active:t===l(f)-1,label:t+1,color:t===l(f)?"lightDark":"whiteDark",small:"",onClick:se=>B(t+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),o("small",null,"Page "+r(l(S))+" of "+r(l(P)),1)]),_:1})])],64))}},Le={__name:"IndexView",setup(M){const $=b([{name:"Inicio"}]),i=Q(),g=b(1),V=b(10),u=ie({switch:[]}),C=a=>{F.index(a).then(n=>{i.members=n,g.value=n.page,V.value=n.perPage})};C({page:g.value});const I=a=>{h({page:a})},w=(a,n)=>{N({sortBy:a,sortDesc:n})},k=b(!1),E=()=>{h(g.value),k.value=u.switch.length!==0},f=a=>{F.getDelete(a).then(n=>{i.members=n,g.value=n.page,V.value=n.perPage})},h=a=>{u.switch.length===0?C(a):f(a)},N=a=>{u.switch.length===0?C(a):f(a)};return(a,n)=>(d(),_(ce,null,{default:c(()=>[m(ue,null,{default:c(()=>{var v,P,S,T,B;return[m(J,{icon:l(de),title:a.$t("message.member.memberships")},{default:c(()=>[m(D,{to:{name:"MembershipsCreate"},icon:l(ge),label:a.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),m(ve,{items:$.value},null,8,["items"]),m(pe,{label:""},{default:c(()=>[m(he,{modelValue:u.switch,"onUpdate:modelValue":n[0]||(n[0]=q=>u.switch=q),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:E},null,8,["modelValue"])]),_:1}),(v=l(i))!=null&&v.members?H("",!0):(d(),_(J,{key:0,icon:a.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(P=l(i))!=null&&P.members?H("",!0):(d(),_(be,{key:1,color:"danger",icon:a.mdiTableOff},{default:c(()=>[o("b",null,r(a.$t("message.empty_table"))+".",1),y(" When there's nothing to show ")]),_:1},8,["icon"])),(B=(T=(S=l(i))==null?void 0:S.members)==null?void 0:T.miembros)!=null&&B.length?(d(),_(W,{key:2,class:"mb-6","has-table":""},{default:c(()=>[m(Me,{checkDelete:k.value,onChangePage:I,onSort:w},null,8,["checkDelete"])]),_:1})):(d(),_(W,{key:3},{default:c(()=>[m(fe)]),_:1}))]}),_:1})]),_:1}))}};export{Le as default};
