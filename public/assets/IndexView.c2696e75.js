import{af as se,ag as ae,a9 as le,R as z,I as v,y as f,o as m,r as U,a as o,w as u,j as l,f as w,E as i,Z as G,J as F,K as H,P as L,d as D,u as c,ah as ne,ai as R,aj as oe,ak as ie,A as J,c as _,S as ce,x as ue,_ as re,b as K,an as de,B as me,O as W,e as ge,g as Z,i as fe,ao as he,ap as ve}from"./index.2b059d96.js";import{C as be}from"./CardBoxComponentEmpty.c5973077.js";import{c as N}from"./cities.service.90aa5314.js";import{_ as $e}from"./FormCheckRadioGroup.f120ae1c.js";import"./FormCheckRadio.b0cf8ca6.js";const pe=l("th",null,null,-1),_e=["onClick"],ke=["data-label"],Ce=["data-label"],ye=["data-label"],Pe=["data-label"],we={class:"before:hidden lg:w-1 whitespace-nowrap"},De={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Ve={__name:"CityTable",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(V,{emit:$}){const{t:r}=se(),g=ae(),S=le(),d=z(),k=v(()=>d.cities.ciudades),B=v(()=>d.cities.total),C=f(!1),y=f(!1),p=f([]),I=v(()=>d.cities.perPage),h=v(()=>d.cities.page);f([]);const j=v(()=>k.value),a=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=f(!1),b=e=>{n.value=!n.value,$("sort",e,n.value)},P=v(()=>Math.ceil(B.value/I.value)),M=v(()=>+h.value),E=v(()=>{const e=[];for(let t=0;t<P.value;t++)e.push(t);return e}),T=e=>{$("changePage",e)},O=e=>{S.push({name:"CitiesUpdate",params:{id:e}})},Q=e=>p.value=e,q=()=>{const{nombre:e}=p.value;return e},X=r("message.city.deleted.success"),Y=async()=>{x().then(()=>{g.success(X),$("changePage",h.value)}).catch(e=>{var t;g.error(`${r("message.city.deleted.error")} ${(t=e==null?void 0:e.response)==null?void 0:t.data.msg}`)})},x=()=>{const{_id:e}=p.value;return N.delete(e)},ee=()=>{const{_id:e}=p.value;N.restore(e).then(()=>{g.success(r("message.city.restore.success")),$("changePage",h.value)}).catch(t=>{var s;g.error(`${r("message.city.restore.error")} ${(s=t==null?void 0:t.response)==null?void 0:s.data.msg}`)})};return(e,t)=>(m(),U(F,null,[o(G,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),title:"Please confirm",button:"danger",onConfirm:Y,"has-cancel":""},{default:u(()=>[l("strong",null,[w(i(e.$t("message.state.deleted.question"))+" ",1),l("b",null,i(q()),1)]),w(" ? ")]),_:1},8,["modelValue"]),o(G,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=s=>C.value=s),title:"Please confirm",onConfirm:ee},{default:u(()=>[l("strong",null,[w(i(e.$t("message.city.restore.question"))+" ",1),l("b",null,i(q()),1)]),w(" ? ")]),_:1},8,["modelValue"]),l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:t[2]||(t[2]=s=>b("codigo"))},i(e.$t("message.city.code")),1),l("th",{onClick:t[3]||(t[3]=s=>b("nombre"))},i(e.$t("message.city.name")),1),l("th",{onClick:t[4]||(t[4]=s=>b("nombre"))},i(e.$t("message.city.state")),1),l("th",{onClick:t[5]||(t[5]=s=>b("estado"))},i(e.$t("message.city.status")),1),pe])]),l("tbody",null,[(m(!0),U(F,null,H(c(j),(s,te)=>(m(),U("tr",{key:s._id,onClick:A=>Q(s)},[l("td",{"data-label":e.$t("message.city.code")},i(s.codigo),9,ke),l("td",{"data-label":e.$t("message.city.state")},i(s.state.nombre),9,Ce),l("td",{"data-label":e.$t("message.city.name")},i(s.nombre),9,ye),l("td",{"data-label":e.$t("message.city.status")},i(e.$t(`message.city.statuses.${a(s.estado)}`)),9,Pe),l("td",we,[o(J,{type:"justify-start lg:justify-end","no-wrap":""},{default:u(()=>[L(o(D,{color:"success",icon:c(ne),small:"",onClick:t[6]||(t[6]=A=>C.value=!0)},null,8,["icon"]),[[R,V.checkDelete&&s.estado===2]]),L(o(D,{color:"info",icon:c(oe),small:"",onClick:A=>O(s._id)},null,8,["icon","onClick"]),[[R,!V.checkDelete&&s.estado!==2]]),L(o(D,{color:"danger",icon:c(ie),small:"",onClick:t[7]||(t[7]=A=>y.value=!0)},null,8,["icon"]),[[R,!V.checkDelete&&s.estado!==2]])]),_:2},1024)])],8,_e))),128))])]),l("div",De,[o(ce,null,{default:u(()=>[o(J,null,{default:u(()=>[(m(!0),U(F,null,H(c(E),s=>(m(),_(D,{key:s,active:s===c(h)-1,label:s+1,color:s===c(h)?"lightDark":"whiteDark",small:"",onClick:te=>T(s+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),l("small",null,"Page "+i(c(M))+" of "+i(c(P)),1)]),_:1})])],64))}},Te={__name:"IndexView",setup(V){const $=f([{name:"Inicio"}]),r=z(),g=f(1),S=f(10),d=ue({switch:[]}),k=a=>{N.index(a).then(n=>{r.cities=n,g.value=n.page,S.value=n.perPage})};k({page:g.value});const B=f(!1),C=()=>{h({page:g.value}),B.value=d.switch.length!==0},y=a=>{h({page:a})},p=(a,n)=>{j({sortBy:a,sortDesc:n})},I=a=>{N.getDelete(a).then(n=>{r.cities=n,g.value=n.page,S.value=n.perPage})},h=a=>{d.switch.length===0?k({page:a}):I({page:a})},j=a=>{d.switch.length===0?k(a):I(a)};return(a,n)=>(m(),_(re,null,{default:u(()=>[o(fe,null,{default:u(()=>{var b,P,M,E,T;return[o(K,{icon:c(he),title:a.$t("message.city.cities")},{default:u(()=>[o(D,{to:{name:"CitiesCreate"},icon:c(ve),label:a.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),o(de,{items:$.value},null,8,["items"]),o(me,{label:""},{default:u(()=>[o($e,{modelValue:d.switch,"onUpdate:modelValue":n[0]||(n[0]=O=>d.switch=O),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:C},null,8,["modelValue"])]),_:1}),(b=c(r))!=null&&b.cities?W("",!0):(m(),_(K,{key:0,icon:a.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(P=c(r))!=null&&P.cities?W("",!0):(m(),_(ge,{key:1,color:"danger",icon:a.mdiTableOff},{default:u(()=>[l("b",null,i(a.$t("message.empty_table"))+".",1),w(" When there's nothing to show ")]),_:1},8,["icon"])),(T=(E=(M=c(r))==null?void 0:M.cities)==null?void 0:E.ciudades)!=null&&T.length?(m(),_(Z,{key:2,class:"mb-6","has-table":""},{default:u(()=>[o(Ve,{checkDelete:B.value,onChangePage:y,onSort:p},null,8,["checkDelete"])]),_:1})):(m(),_(Z,{key:3},{default:u(()=>[o(be)]),_:1}))]}),_:1})]),_:1}))}};export{Te as default};
