import{u as x,ak as D,au as I,ae as O,r as k,ax as A,g as E,o as G,c as H,a as c,b as L,i as l,N as J,d as K,_ as b,p as i,ay as Q,S as W,az as X,ar as U,j as Y}from"./index.97cc49ea.js";import{a as M,_ as Z}from"./BaseButton.fb27d38b.js";import{_ as f}from"./FormField.649b9cf9.js";import{r as N,u as P}from"./index.esm.4f920791.js";import{c as ee}from"./countries.service.0aa74def.js";import{s as h}from"./states.services.c9f5fb01.js";const se={style:{display:"flex","justify-content":"space-between"}},ne={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(v){const p=v,{t:m}=x(),y=D(),R=I(),_=O();let $=[{id:1,label:m("message.state.statuses.active")},{id:0,label:m("message.state.statuses.inactive")},{id:2,label:m("message.state.statuses.deleted")}],V=k([]);const t=k({_id:"",codigo:"00",nombre:"",estado:$[0],pais:V.value}),j=s=>{const{_id:e,codigo:o,nombre:a,estado:n,pais:d}=s.value,r={_id:e,codigo:o,nombre:a,estado:n.id,pais:d.id};return p.path==="create"?h.create(r):h.update(r)};A(async()=>{var o;let s=await ee.index();const e=(s==null?void 0:s.paises)||[];if(V.value=e.map(a=>({id:a._id,label:a.nombre})),console.log(p.path),p.path==="update"){const a=await h.read(R.params),n=((o=a.data)==null?void 0:o.pais)||[],d=e.filter(r=>r._id==n._id)[0];t.value=a.data,t.value.estado=$.filter(r=>r.id===a.data.estado)[0],t.value.pais={id:d._id,label:d.nombre}}});const z=E(()=>({nombre:{required:N},estado:{required:N}})),g=P(z,t),F=p.path==="create"?m("message.state.created.success"):m("message.state.updated.success"),T=async()=>{const s=await g.value.$validate();console.log(s),s?j(t).then(()=>{y.success(F),_.push("/setup/states")}).catch(e=>{var o,a;if((o=e.response.data)!=null&&o.msg){y.error(`${m("message.state.created.error")} ${e.response.data.msg}`);return}if((a=e.response.data)!=null&&a.errors){const n=e.response.data.errors;for(let d of n);}}):console.log("error")},q=()=>_.push("/setup/states");return(s,e)=>(G(),H(Z,{isForm:"",onSubmit:Y(T,["prevent"])},{footer:c(()=>[L("div",se,[l(M,{label:s.$t(`message.${p.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),l(M,{label:s.$t("message.return"),color:"info",onClick:e[4]||(e[4]=o=>q())},null,8,["label"])])]),default:c(()=>{var o,a,n,d,r,w,S,B,C;return[L("div",{class:J(v.path!=="create"?"grid md:grid-cols-2 gap-4":"grid md:grid-cols-3 gap-4")},[K(l(f,{label:s.$t("message.state.code")},{default:c(()=>[l(b,{name:"codigo",modelValue:t.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=u=>t.value.codigo=u),icon:i(Q),readonly:"true"},null,8,["modelValue","icon"])]),_:1},8,["label"]),[[W,v.path!=="create"]]),l(f,{label:s.$t("message.state.name"),help:(n=(a=(o=i(g))==null?void 0:o.nombre)==null?void 0:a.$errors[0])==null?void 0:n.$message},{default:c(()=>[l(b,{modelValue:t.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=u=>t.value.nombre=u),icon:i(X)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),l(f,{label:s.$t("message.state.country"),help:(w=(r=(d=i(g))==null?void 0:d.estado)==null?void 0:r.$errors[0])==null?void 0:w.$message},{default:c(()=>[l(b,{modelValue:t.value.pais,"onUpdate:modelValue":e[2]||(e[2]=u=>t.value.pais=u),icon:i(U),options:i(V)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"]),l(f,{label:s.$t("message.state.status"),help:(C=(B=(S=i(g))==null?void 0:S.estado)==null?void 0:B.$errors[0])==null?void 0:C.$message},{default:c(()=>[l(b,{modelValue:t.value.estado,"onUpdate:modelValue":e[3]||(e[3]=u=>t.value.estado=u),icon:i(U),options:i($)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"])],2)]}),_:1},8,["onSubmit"]))}};export{ne as _};
