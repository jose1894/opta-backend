import{ag as te,ah as ae,aa as le,S as J,I as f,y as b,o as d,r as I,a as m,w as c,j as l,f as y,E as i,$ as G,K as q,L as H,M as A,d as D,u as o,ai as oe,aj as O,ak as ne,al as me,A as K,c as k,T as ie,x as re,_ as ce,b as Q,ao as ue,B as de,Q as W,e as ge,g as z,i as be,ap as he,aq as fe}from"./index.e27aaed2.js";import{C as ve}from"./CardBoxComponentEmpty.8b08f16b.js";import{m as E}from"./member.service.2c2d1fb8.js";import{_ as pe}from"./FormCheckRadioGroup.84cb26fc.js";import"./FormCheckRadio.44135d25.js";const $e=l("th",null,null,-1),_e=["onClick"],ke=["data-label"],Ce=["data-label"],Pe=["data-label"],we=["data-label"],ye={class:"before:hidden lg:w-1 whitespace-nowrap"},De={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Me={__name:"MemberTable.view",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(M,{emit:$}){const{t:r}=te(),g=ae(),V=le(),u=J(),C=f(()=>u.members.miembros),U=f(()=>u.members.total),P=b(!1),_=b(!1),F=f(()=>u.members.perPage),h=f(()=>u.members.page);b([]);const v=b([]),N=f(()=>C.value),a=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=b(!1),p=e=>{n.value=!n.value,$("sort",e,n.value)},w=f(()=>Math.ceil(U.value/F.value)),T=f(()=>+h.value),S=f(()=>{const e=[];for(let s=0;s<w.value;s++)e.push(s);return e}),B=e=>{$("changePage",e)},j=e=>{V.push({name:"MembershipsUpdate",params:{id:e}})},X=e=>v.value=e,R=()=>{const{nombre:e}=v.value;return e},Y=r("message.member.deleted.success"),Z=async()=>{x().then(()=>{g.success(Y),$("changePage",h.value)}).catch(e=>{var s;g.error(`${r("message.member.deleted.error")} ${(s=e==null?void 0:e.response)==null?void 0:s.data.msg}`)})},x=()=>{const{_id:e}=v.value;return E.delete(e)},ee=()=>{const{_id:e}=v.value;E.restore(e).then(()=>{g.success(r("message.member.restore.success")),$("changePage",h.value)}).catch(s=>{var t;g.error(`${r("message.member.restore.error")} ${(t=s==null?void 0:s.response)==null?void 0:t.data.msg}`)})};return(e,s)=>(d(),I(q,null,[m(G,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=t=>_.value=t),title:"Please confirm",button:"danger",onConfirm:Z,"has-cancel":""},{default:c(()=>[l("strong",null,[y(i(e.$t("message.member.deleted.question"))+" ",1),l("b",null,i(R()),1)]),y(" ? ")]),_:1},8,["modelValue"]),m(G,{modelValue:P.value,"onUpdate:modelValue":s[1]||(s[1]=t=>P.value=t),title:"Please confirm",onConfirm:ee},{default:c(()=>[l("strong",null,[y(i(e.$t("message.member.restore.question"))+" ",1),l("b",null,i(R()),1)]),y(" ? ")]),_:1},8,["modelValue"]),l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:s[2]||(s[2]=t=>p("codigo"))},i(e.$t("message.member.code")),1),l("th",{onClick:s[3]||(s[3]=t=>p("nombre"))},i(e.$t("message.member.name")),1),l("th",{onClick:s[4]||(s[4]=t=>p("iDFiscal"))},i(e.$t("message.member.id")),1),l("th",{onClick:s[5]||(s[5]=t=>p("estado"))},i(e.$t("message.member.status")),1),$e])]),l("tbody",null,[(d(!0),I(q,null,H(o(N),(t,se)=>(d(),I("tr",{key:t._id,onClick:L=>X(t)},[l("td",{"data-label":e.$t("message.member.code")},i(t.codigo),9,ke),l("td",{"data-label":e.$t("message.member.state")},i(t.nombre),9,Ce),l("td",{"data-label":e.$t("message.member.id")},i(t.iDFiscal),9,Pe),l("td",{"data-label":e.$t("message.member.status")},i(e.$t(`message.member.statuses.${a(t.estado)}`)),9,we),l("td",ye,[m(K,{type:"justify-start lg:justify-end","no-wrap":""},{default:c(()=>[A(m(D,{color:"success",icon:o(oe),messageTooltip:o(r)("message.restore"),small:"",onClick:s[6]||(s[6]=L=>P.value=!0)},null,8,["icon","messageTooltip"]),[[O,M.checkDelete&&t.estado===2]]),A(m(D,{color:"info",icon:o(ne),messageTooltip:o(r)("message.edit"),small:"",onClick:L=>j(t._id)},null,8,["icon","messageTooltip","onClick"]),[[O,!M.checkDelete&&t.estado!==2]]),A(m(D,{color:"danger",icon:o(me),messageTooltip:o(r)("message.delete"),small:"",onClick:s[7]||(s[7]=L=>_.value=!0)},null,8,["icon","messageTooltip"]),[[O,!M.checkDelete&&t.estado!==2]])]),_:2},1024)])],8,_e))),128))])]),l("div",De,[m(ie,null,{default:c(()=>[m(K,null,{default:c(()=>[(d(!0),I(q,null,H(o(S),t=>(d(),k(D,{key:t,active:t===o(h)-1,label:t+1,color:t===o(h)?"lightDark":"whiteDark",small:"",onClick:se=>B(t+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),l("small",null,"Page "+i(o(T))+" of "+i(o(w)),1)]),_:1})])],64))}},Ee={__name:"IndexView",setup(M){const $=b([{name:"Inicio"}]),r=J(),g=b(1),V=b(10),u=re({switch:[]}),C=a=>{E.index(a).then(n=>{r.members=n,g.value=n.page,V.value=n.perPage})};C({page:g.value});const U=a=>{v({page:a})},P=(a,n)=>{N({sortBy:a,sortDesc:n})},_=b(!1),F=()=>{v({page:g.value}),_.value=u.switch.length!==0},h=a=>{E.getDelete(a).then(n=>{r.members=n,g.value=n.page,V.value=n.perPage})},v=a=>{u.switch.length===0?C({page:a}):h({page:a})},N=a=>{u.switch.length===0?C(a):h(a)};return(a,n)=>(d(),k(ce,null,{default:c(()=>[m(be,null,{default:c(()=>{var p,w,T,S,B;return[m(Q,{icon:o(he),title:a.$t("message.member.memberships")},{default:c(()=>[m(D,{to:{name:"MembershipsCreate"},icon:o(fe),label:a.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),m(ue,{items:$.value},null,8,["items"]),m(de,{label:""},{default:c(()=>[m(pe,{modelValue:u.switch,"onUpdate:modelValue":n[0]||(n[0]=j=>u.switch=j),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:F},null,8,["modelValue"])]),_:1}),(p=o(r))!=null&&p.members?W("",!0):(d(),k(Q,{key:0,icon:a.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(w=o(r))!=null&&w.members?W("",!0):(d(),k(ge,{key:1,color:"danger",icon:a.mdiTableOff},{default:c(()=>[l("b",null,i(a.$t("message.empty_table"))+".",1),y(" When there's nothing to show ")]),_:1},8,["icon"])),(B=(S=(T=o(r))==null?void 0:T.members)==null?void 0:S.miembros)!=null&&B.length?(d(),k(z,{key:2,class:"mb-6","has-table":""},{default:c(()=>[m(Me,{checkDelete:_.value,onChangePage:U,onSort:P},null,8,["checkDelete"])]),_:1})):(d(),k(z,{key:3},{default:c(()=>[m(ve)]),_:1}))]}),_:1})]),_:1}))}};export{Ee as default};
