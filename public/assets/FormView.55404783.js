import{ag as ae,ah as le,at as oe,aa as se,y as U,au as ie,I as te,o as ne,c as ue,w as n,j as k,a as o,d as Q,B as u,u as t,C as r,aw as v,ax as V,z as re,g as de}from"./index.e27aaed2.js";import{r as E,u as pe}from"./index.esm.6263d8b1.js";import{p as H}from"./personal.service.ad7206b3.js";import{p as me}from"./Professions.service.6b08311e.js";import{l as ce}from"./languages.service.441e1ab6.js";import{b as ve}from"./bussinesUnit.service.20bca8ab.js";import{c as ge}from"./categories.service.315771c8.js";import{b as be}from"./branches.service.3487c96a.js";import{p as fe}from"./profiles.service.8ec61cb8.js";const Ve={class:"grid md:grid-cols-3 gap-3"},$e={class:"grid md:grid-cols-1 gap-1"},Ue={class:"grid gap-1"},we={style:{display:"flex","justify-content":"space-between"}},Ce={__name:"FormView",props:{path:"",saveLabel:"",country:{}},setup(W){const N=W,{t:m}=ae(),J=le(),X=oe(),K=se(),I=[{id:1,label:m("message.personal.statuses.active")},{id:0,label:m("message.personal.statuses.inactive")}],O=[{id:0,label:m("message.personal.others")},{id:1,label:m("message.personal.partner")},{id:2,label:m("message.personal.manager")}];let R=U([]),T=U([]),j=U([]),G=U([]),q=U([]),z=U([]);const e=U({_id:"",nombres:"",apellidos:"",apelidos:"",iDFiscal:"",telefono:"",email:"",direccion:"",profesion:R.value,idiomas:T.value,postgrado:"",unidadNegocio:j.value,categoria:G.value,sucursal:q.value,perfil:z.value,usuarioAcceso:"",claveAcceso:"",estado:I[0],tipoPersonal:O[0]}),Y=s=>{const{_id:a,nombres:d,apellidos:c,iDFiscal:p,telefono:$,email:g,direccion:y,profesion:b,idiomas:P,postgrado:f,unidadNegocio:l,categoria:F,sucursal:L,perfil:B,usuarioAcceso:D,claveAcceso:C,tipoPersonal:M,estado:i}=s.value,S={_id:a,nombres:d,apellidos:c,iDFiscal:p,telefono:$,email:g,direccion:y,profesion:b.id,idiomas:P.id,postgrado:f,unidadNegocio:l.id,categoria:F.id,sucursal:L.id,perfil:B.id,usuarioAcceso:D,claveAcceso:C,tipoPersonal:M.id,estado:i.id};return N.path==="create"?H.create(S):H.update(S)};ie(async()=>{var F,L,B,D,C,M;let s=await me.allProfesiones();const a=s==null?void 0:s.data.profesiones;R.value=a.map(i=>({id:i._id,label:i.nombre}));let d=await ce.allIdiomas();const c=d==null?void 0:d.data.idiomas;T.value=c.map(i=>({id:i._id,label:i.nombre}));let p=await ve.allBussinesUnitGet();const $=p==null?void 0:p.data.unidadesNegocio;j.value=$.map(i=>({id:i._id,label:i.nombre}));let g=await ge.allCategoris();const y=g==null?void 0:g.data.categorias;G.value=y.map(i=>({id:i._id,label:i.nombre}));let b=await be.sucursalesGet();const P=b==null?void 0:b.data.sucursales;q.value=P.map(i=>({id:i._id,label:i.nombre}));let f=await fe.allPerfiles();const l=f==null?void 0:f.data.perfiles;if(z.value=l.map(i=>({id:i._id,label:i.descripcion})),N.path==="update"){const i=await H.read(X.params);e.value=i.data,e.value.tipoPersonal=O.filter(S=>S.id===i.data.tipoPersonal)[0],e.value.estado=I.filter(S=>S.id===i.data.estado)[0],e.value.profesion=w((F=i.data)==null?void 0:F.profesion),e.value.idiomas=w((L=i.data)==null?void 0:L.idiomas),e.value.unidadNegocio=w((B=i.data)==null?void 0:B.unidadNegocio),e.value.categoria=w((D=i.data)==null?void 0:D.categoria),e.value.sucursal=w((C=i.data)==null?void 0:C.sucursal),e.value.perfil=w((M=i.data)==null?void 0:M.perfil)}});const w=s=>({id:s._id,label:(s==null?void 0:s.nombre)||(s==null?void 0:s.descripcion)}),Z=te(()=>({iDFiscal:{required:E},nombres:{required:E},estado:{required:E}})),A=pe(Z,e),_=N.path==="create"?m("message.personal.created.success"):m("message.personal.updated.success"),h=N.path==="create"?m("message.personal.created.error"):m("message.personal.updated.error"),x=async()=>{await A.value.$validate()?Y(e).then(()=>{J.success(_),K.push("/setup/personal")}).catch(a=>{var d,c;if((d=a.response.data)!=null&&d.msg){J.error(`${h} ${a.response.data.msg}`);return}if((c=a.response.data)!=null&&c.errors){const p=a.response.data.errors;for(let $ of p);}}):console.log("error")},ee=()=>K.push("/setup/personal");return(s,a)=>(ne(),ue(de,{isForm:"",onSubmit:re(x,["prevent"])},{footer:n(()=>[k("div",we,[o(Q,{label:s.$t(`message.${N.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),o(Q,{label:s.$t("message.return"),color:"info",onClick:a[17]||(a[17]=d=>ee())},null,8,["label"])])]),default:n(()=>{var d,c,p,$,g,y,b,P,f;return[k("div",Ve,[o(u,{label:s.$t("message.personal.names"),help:(p=(c=(d=t(A))==null?void 0:d.nombres)==null?void 0:c.$errors[0])==null?void 0:p.$message},{default:n(()=>[o(r,{name:"nombres",modelValue:e.value.nombres,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.nombres=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(u,{label:s.$t("message.personal.surnames")},{default:n(()=>[o(r,{modelValue:e.value.apellidos,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.apellidos=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.idFiscal"),help:(y=(g=($=t(A))==null?void 0:$.iDFiscal)==null?void 0:g.$errors[0])==null?void 0:y.$message},{default:n(()=>[o(r,{modelValue:e.value.iDFiscal,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.iDFiscal=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(u,{label:s.$t("message.personal.phone")},{default:n(()=>[o(r,{modelValue:e.value.telefono,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.telefono=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.email")},{default:n(()=>[o(r,{modelValue:e.value.email,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.email=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.profession")},{default:n(()=>[o(r,{modelValue:e.value.profesion,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.profesion=l),icon:t(V),options:t(R)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.languages")},{default:n(()=>[o(r,{modelValue:e.value.idiomas,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.idiomas=l),icon:t(V),options:t(T)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.postgraduate")},{default:n(()=>[o(r,{modelValue:e.value.postgrado,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.postgrado=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.businessUnit")},{default:n(()=>[o(r,{modelValue:e.value.unidadNegocio,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.unidadNegocio=l),icon:t(V),options:t(j)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.category")},{default:n(()=>[o(r,{modelValue:e.value.categoria,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.categoria=l),icon:t(V),options:t(G)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.branch")},{default:n(()=>[o(r,{modelValue:e.value.sucursal,"onUpdate:modelValue":a[10]||(a[10]=l=>e.value.sucursal=l),icon:t(V),options:t(q)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.profile")},{default:n(()=>[o(r,{modelValue:e.value.perfil,"onUpdate:modelValue":a[11]||(a[11]=l=>e.value.perfil=l),icon:t(V),options:t(z)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.user")},{default:n(()=>[o(r,{modelValue:e.value.usuarioAcceso,"onUpdate:modelValue":a[12]||(a[12]=l=>e.value.usuarioAcceso=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.password")},{default:n(()=>[o(r,{modelValue:e.value.claveAcceso,"onUpdate:modelValue":a[13]||(a[13]=l=>e.value.claveAcceso=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.status"),help:(f=(P=(b=t(A))==null?void 0:b.estado)==null?void 0:P.$errors[0])==null?void 0:f.$message},{default:n(()=>[o(r,{modelValue:e.value.estado,"onUpdate:modelValue":a[14]||(a[14]=l=>e.value.estado=l),icon:t(V),options:I},null,8,["modelValue","icon"])]),_:1},8,["label","help"])]),k("div",$e,[o(u,{label:s.$t("message.personal.typePersonnel")},{default:n(()=>[o(r,{modelValue:e.value.tipoPersonal,"onUpdate:modelValue":a[15]||(a[15]=l=>e.value.tipoPersonal=l),icon:t(V),options:O},null,8,["modelValue","icon"])]),_:1},8,["label"])]),k("div",Ue,[o(u,{label:s.$t("message.personal.address")},{default:n(()=>[o(r,{type:"textarea",modelValue:e.value.direccion,"onUpdate:modelValue":a[16]||(a[16]=l=>e.value.direccion=l),icon:t(v)},null,8,["modelValue","icon"])]),_:1},8,["label"])])]}),_:1},8,["onSubmit"]))}};export{Ce as _};
