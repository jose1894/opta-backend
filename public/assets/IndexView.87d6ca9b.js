import{af as Y,ag as x,a9 as ee,R as G,I as g,y as h,o as u,r as D,a as i,w as c,j as n,f as N,E as r,Z as te,J as M,K as j,d as R,u as l,aj as ae,P as se,ak as ne,ai as oe,A as F,c as $,S as le,x as re,_ as ie,b as L,B as ce,O,e as ue,g as A,i as de,ao as me,ap as ge,p as q}from"./index.2b059d96.js";import{C as fe}from"./CardBoxComponentEmpty.c5973077.js";import{r as I}from"./rates.service.04263bdf.js";import{_ as pe}from"./FormCheckRadioGroup.f120ae1c.js";import"./FormCheckRadio.b0cf8ca6.js";const _e=["onClick"],he=["data-label"],ve=["data-label"],be=["data-label"],$e=["data-label"],ke={class:"before:hidden lg:w-1 whitespace-nowrap"},Ce={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Pe={__name:"RateTable",props:{checkable:Boolean},emits:["changePage","confirm","sort"],setup(H,{emit:d}){const{t:f}=Y(),k=x(),v=ee(),m=G(),U=g(()=>m.rates.tasas),B=g(()=>m.rates.total);h(!1);const C=h(!1),w=g(()=>m.rates.perPage),p=g(()=>m.rates.page);h([]);const P=h([]),s=g(()=>U.value),o=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],b=h(!1),_=e=>{b.value=!b.value,d("sort",e,b.value)},y=g(()=>Math.ceil(B.value/w.value)),S=g(()=>+p.value),V=g(()=>{const e=[];for(let t=0;t<y.value;t++)e.push(t);return e}),E=e=>{d("changePage",e)},J=e=>{v.push({name:"RatesUpdate",params:{id:e}})},K=e=>P.value=e,W=()=>{const{nombre:e}=P.value;return e},Z=f("message.rate.deleted.success"),z=async()=>{Q().then(()=>{k.success(Z),d("changePage",p.value)}).catch(e=>{var t;k.error(`${f("message.rate.deleted.error")} ${(t=e==null?void 0:e.response)==null?void 0:t.data.msg}`)})},Q=()=>{const{_id:e}=P.value;return I.delete(e)};return(e,t)=>(u(),D(M,null,[i(te,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=a=>C.value=a),title:"Please confirm",button:"danger",onConfirm:z,"has-cancel":""},{default:c(()=>[n("strong",null,[N(r(e.$t("message.rate.deleted.question"))+" ",1),n("b",null,r(W()),1)]),N(" ? ")]),_:1},8,["modelValue"]),n("table",null,[n("thead",null,[n("tr",null,[n("th",{onClick:t[1]||(t[1]=a=>_("siglas"))},r(e.$t("message.rate.acronyms")),1),n("th",{onClick:t[2]||(t[2]=a=>_("nombre"))},r(e.$t("message.rate.category")),1),n("th",{onClick:t[3]||(t[3]=a=>_("estado"))},r(e.$t("message.rate.businessUnit")),1),n("th",{onClick:t[4]||(t[4]=a=>_("estado"))},r(e.$t("message.rate.status")),1)])]),n("tbody",null,[(u(!0),D(M,null,j(l(s),(a,X)=>(u(),D("tr",{key:a._id,onClick:T=>K(a)},[n("td",{"data-label":e.$t("message.rate.acronyms")},r(a.siglas),9,he),n("td",{"data-label":e.$t("message.rate.category")},r(a.categoria.nombre),9,ve),n("td",{"data-label":e.$t("message.rate.businessUnit")},r(a.unidadNegocio.nombre),9,be),n("td",{"data-label":e.$t("message.rate.status")},r(e.$t(`message.rate.statuses.${o(a.estado)}`)),9,$e),n("td",ke,[i(F,{type:"justify-start lg:justify-end","no-wrap":""},{default:c(()=>[i(R,{color:"info",icon:l(ae),small:"",onClick:T=>J(a._id)},null,8,["icon","onClick"]),se(i(R,{color:"danger",icon:l(ne),small:"",onClick:t[5]||(t[5]=T=>C.value=!0)},null,8,["icon"]),[[oe,a.estado!==2]])]),_:2},1024)])],8,_e))),128))])]),n("div",Ce,[i(le,null,{default:c(()=>[i(F,null,{default:c(()=>[(u(!0),D(M,null,j(l(V),a=>(u(),$(R,{key:a,active:a===l(p)-1,label:a+1,color:a===l(p)?"lightDark":"whiteDark",small:"",onClick:X=>E(a+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),n("small",null,"Page "+r(l(S))+" of "+r(l(y)),1)]),_:1})])],64))}},Re={__name:"IndexView",setup(H){const d=G(),f=h(1),k=h(10),v=re({switch:[]}),m=s=>{I.index(s).then(o=>{d.rates=o,f.value=o.page,k.value=o.perPage})};m({page:f.value});const U=()=>{p({page:f.value})},B=s=>{p({page:s})},C=(s,o)=>{P({sortBy:s,sortDesc:o})},w=s=>{I.getDelete(s).then(o=>{d.rates=o,f.value=o.page,k.value=o.perPage})},p=s=>{v.switch.length===0?m({page:s}):w({page:s})},P=(s,o)=>{v.switch.length===0?m({sortBy:s,sortDesc:o}):w({sortBy:s,sortDesc:o})};return(s,o)=>(u(),$(ie,null,{default:c(()=>[i(de,null,{default:c(()=>{var b,_,y,S,V;return[i(L,{icon:l(me),title:s.$t("message.rate.rates")},{default:c(()=>[i(R,{to:"rates/create",icon:l(ge),label:s.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),i(ce,{label:""},{default:c(()=>[i(pe,{modelValue:v.switch,"onUpdate:modelValue":o[0]||(o[0]=E=>v.switch=E),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:U},null,8,["modelValue"])]),_:1}),(b=l(d))!=null&&b.rates?O("",!0):(u(),$(L,{key:0,icon:l(q),title:"Empty variation"},null,8,["icon"])),(_=l(d))!=null&&_.rates?O("",!0):(u(),$(ue,{key:1,color:"danger",icon:l(q)},{default:c(()=>[n("b",null,r(s.$t("message.empty_table"))+".",1),N(" When there's nothing to show ")]),_:1},8,["icon"])),(V=(S=(y=l(d))==null?void 0:y.rates)==null?void 0:S.tasas)!=null&&V.length?(u(),$(A,{key:2,class:"mb-6","has-table":""},{default:c(()=>[i(Pe,{onChangePage:B,onSort:C})]),_:1})):(u(),$(A,{key:3},{default:c(()=>[i(fe)]),_:1}))]}),_:1})]),_:1}))}};export{Re as default};
