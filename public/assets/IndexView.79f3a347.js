import{af as se,ag as ae,a9 as ne,R as Z,I as h,y as p,o as m,r as I,a as o,w as i,j as n,f as x,E as u,Z as q,J as A,K as G,P as F,d as y,u as c,ah as le,ai as L,aj as oe,ak as ce,A as H,c as b,S as ie,x as ue,_ as re,b as J,an as de,B as me,O as K,e as ge,g as W,i as pe,ao as fe,ap as he}from"./index.cb093d8e.js";import{C as ve}from"./CardBoxComponentEmpty.87377cbc.js";import{e as M}from"./expense.service.0a193c5a.js";import{_ as _e}from"./FormCheckRadioGroup.d9d00b52.js";import"./FormCheckRadio.256f47df.js";const $e=n("th",null,null,-1),be=["onClick"],ke=["data-label"],Ce=["data-label"],Pe={class:"before:hidden lg:w-1 whitespace-nowrap"},we={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},xe={__name:"ExpenseTableView",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(D,{emit:_}){const{t:r}=se(),g=ae(),V=ne(),d=Z(),k=h(()=>d.expense.gastos),T=h(()=>d.expense.total),C=p(!1),$=p(!1),U=h(()=>d.expense.perPage),f=h(()=>d.expense.page),v=p([]);p([]);const N=h(()=>k.value),a=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],l=p(!1),P=e=>{l.value=!l.value,_("sort",e,l.value)},w=h(()=>Math.ceil(T.value/U.value)),E=h(()=>+f.value),S=h(()=>{const e=[];for(let t=0;t<w.value;t++)e.push(t);return e}),B=e=>{_("changePage",e)},j=e=>{V.push({name:"ExpenseUpdate",params:{id:e}})},z=e=>v.value=e,R=()=>{const{concepto:e}=v.value;return e},Q=r("message.expense.deleted.success"),X=async()=>{Y().then(()=>{g.success(Q),_("changePage",f.value)}).catch(e=>{var t;g.error(`${r("message.expense.deleted.error")} ${(t=e==null?void 0:e.response)==null?void 0:t.data.msg}`)})},Y=()=>{const{_id:e}=v.value;return M.delete(e)},ee=()=>{const{_id:e}=v.value;M.restore(e).then(()=>{g.success(r("message.expense.restore.success")),_("changePage",f.value)}).catch(t=>{var s;g.error(`${r("message.expense.restore.error")} ${(s=t==null?void 0:t.response)==null?void 0:s.data.msg}`)})};return(e,t)=>(m(),I(A,null,[o(q,{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=s=>$.value=s),title:"Please confirm",button:"danger",onConfirm:X,"has-cancel":""},{default:i(()=>[n("strong",null,[x(u(e.$t("message.expense.deleted.question"))+" ",1),n("b",null,u(R()),1)]),x(" ? ")]),_:1},8,["modelValue"]),o(q,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=s=>C.value=s),title:"Please confirm",onConfirm:ee},{default:i(()=>[n("strong",null,[x(u(e.$t("message.expense.restore.question"))+" ",1),n("b",null,u(R()),1)]),x(" ? ")]),_:1},8,["modelValue"]),n("table",null,[n("thead",null,[n("tr",null,[n("th",{onClick:t[2]||(t[2]=s=>P("concepto"))},u(e.$t("message.expense.concept")),1),n("th",{onClick:t[3]||(t[3]=s=>P("estado"))},u(e.$t("message.expense.status")),1),$e])]),n("tbody",null,[(m(!0),I(A,null,G(c(N),(s,te)=>(m(),I("tr",{key:s._id,onClick:O=>z(s)},[n("td",{"data-label":e.$t("message.expense.concept")},u(s.concepto),9,ke),n("td",{"data-label":e.$t("message.expense.status")},u(e.$t(`message.expense.statuses.${a(s.estado)}`)),9,Ce),n("td",Pe,[o(H,{type:"justify-start lg:justify-end","no-wrap":""},{default:i(()=>[F(o(y,{color:"success",icon:c(le),small:"",onClick:t[4]||(t[4]=O=>C.value=!0)},null,8,["icon"]),[[L,D.checkDelete&&s.estado===2]]),F(o(y,{color:"info",icon:c(oe),small:"",onClick:O=>j(s._id)},null,8,["icon","onClick"]),[[L,!D.checkDelete&&s.estado!==2]]),F(o(y,{color:"danger",icon:c(ce),small:"",onClick:t[5]||(t[5]=O=>$.value=!0)},null,8,["icon"]),[[L,!D.checkDelete&&s.estado!==2]])]),_:2},1024)])],8,be))),128))])]),n("div",we,[o(ie,null,{default:i(()=>[o(H,null,{default:i(()=>[(m(!0),I(A,null,G(c(S),s=>(m(),b(y,{key:s,active:s===c(f)-1,label:s+1,color:s===c(f)?"lightDark":"whiteDark",small:"",onClick:te=>B(s+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),n("small",null,"Page "+u(c(E))+" of "+u(c(w)),1)]),_:1})])],64))}},Be={__name:"IndexView",setup(D){const _=p([{name:"Inicio"}]),r=Z(),g=p(1),V=p(10),d=ue({switch:[]}),k=a=>{M.index(a).then(l=>{r.expense=l,g.value=l.page,V.value=l.perPage})};k({page:g.value});const T=a=>{v({page:a})},C=(a,l)=>{N({sortBy:a,sortDesc:l})},$=p(!1),U=()=>{v({page:g.value}),$.value=d.switch.length!==0},f=a=>{M.getDelete(a).then(l=>{r.expense=l,g.value=l.page,V.value=l.perPage})},v=a=>{d.switch.length===0?k({page:a}):f({page:a})},N=a=>{d.switch.length===0?k(a):f(a)};return(a,l)=>(m(),b(re,null,{default:i(()=>[o(pe,null,{default:i(()=>{var P,w,E,S,B;return[o(J,{icon:c(fe),title:a.$t("message.expense.expense")},{default:i(()=>[o(y,{to:{name:"ExpenseCreate"},icon:c(he),label:a.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),o(de,{items:_.value},null,8,["items"]),o(me,{label:""},{default:i(()=>[o(_e,{modelValue:d.switch,"onUpdate:modelValue":l[0]||(l[0]=j=>d.switch=j),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:U},null,8,["modelValue"])]),_:1}),(P=c(r))!=null&&P.expense?K("",!0):(m(),b(J,{key:0,icon:a.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(w=c(r))!=null&&w.expense?K("",!0):(m(),b(ge,{key:1,color:"danger",icon:a.mdiTableOff},{default:i(()=>[n("b",null,u(a.$t("message.empty_table"))+".",1),x(" When there's nothing to show ")]),_:1},8,["icon"])),(B=(S=(E=c(r))==null?void 0:E.expense)==null?void 0:S.gastos)!=null&&B.length?(m(),b(W,{key:2,class:"mb-6","has-table":""},{default:i(()=>[o(xe,{checkDelete:$.value,onChangePage:T,onSort:C},null,8,["checkDelete"])]),_:1})):(m(),b(W,{key:3},{default:i(()=>[o(ve)]),_:1}))]}),_:1})]),_:1}))}};export{Be as default};
