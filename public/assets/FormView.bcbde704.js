import{af as oe,ag as se,as as ie,a9 as te,y as $,at as ne,I as ue,o as re,c as de,w as n,a as o,d as me,j as K,B as u,u as t,C as r,av as b,aw as v,z as pe,g as ce}from"./index.cb093d8e.js";import{r as Q,u as be}from"./index.esm.25e21f11.js";import{p as W}from"./personal.service.7231022b.js";import{p as ve}from"./Professions.service.4f176a02.js";import{l as ge}from"./languages.service.311dc936.js";import{b as fe}from"./bussinesUnit.service.4b89b5a3.js";import{c as Ve}from"./categories.service.70370546.js";import{b as $e}from"./branches.service.075422d5.js";import{m as Ue}from"./member.service.19ca38e4.js";import{p as we}from"./profiles.service.3d0baa48.js";const Se={class:"grid md:grid-cols-3 gap-3"},Pe={class:"grid md:grid-cols-2 gap-2"},Le={class:"grid gap-1"},Oe={__name:"FormView",props:{path:"",saveLabel:"",country:{}},setup(Y){const L=Y,{t:m}=oe(),X=se(),Z=ie(),_=te(),I=[{id:1,label:m("message.personal.statuses.active")},{id:0,label:m("message.personal.statuses.inactive")},{id:2,label:m("message.personal.statuses.deleted")}],O=[{id:0,label:m("message.personal.others")},{id:1,label:m("message.personal.partner")},{id:2,label:m("message.personal.manager")}];let R=$([]),k=$([]),T=$([]),j=$([]),q=$([]),z=$([]),E=$([]);const e=$({_id:"",nombres:"",apellidos:"",apelidos:"",iDFiscal:"",telefono:"",email:"",direccion:"",profesion:R.value,idiomas:k.value,postgrado:"",unidadNegocio:T.value,categoria:j.value,sucursal:q.value,perfil:z.value,usuarioAcceso:"",claveAcceso:"",miembro:E.value,estado:I[0],tipoPersonal:O[0]}),h=s=>{const{_id:a,nombres:d,apellidos:c,iDFiscal:p,telefono:w,email:g,direccion:S,profesion:f,idiomas:P,postgrado:V,unidadNegocio:l,categoria:N,sucursal:H,perfil:F,usuarioAcceso:B,claveAcceso:D,miembro:M,tipoPersonal:C,estado:G}=s.value,y={_id:a,nombres:d,apellidos:c,iDFiscal:p,telefono:w,email:g,direccion:S,profesion:f.id,idiomas:P.id,postgrado:V,unidadNegocio:l.id,categoria:N.id,sucursal:H.id,perfil:F.id,usuarioAcceso:B,claveAcceso:D,miembro:M.id,tipoPersonal:C.id,estado:G.id};return L.path==="create"?W.create(y):W.update(y)};ne(async()=>{var F,B,D,M,C,G,y;let s=await ve.allProfesiones();const a=s==null?void 0:s.data.profesiones;R.value=a.map(i=>({id:i._id,label:i.nombre}));let d=await ge.allIdiomas();const c=d==null?void 0:d.data.idiomas;k.value=c.map(i=>({id:i._id,label:i.nombre}));let p=await fe.allBussinesUnitGet();const w=p==null?void 0:p.data.unidadesNegocio;T.value=w.map(i=>({id:i._id,label:i.nombre}));let g=await Ve.allCategoris();const S=g==null?void 0:g.data.categorias;j.value=S.map(i=>({id:i._id,label:i.nombre}));let f=await $e.sucursalesGet();const P=f==null?void 0:f.data.sucursales;q.value=P.map(i=>({id:i._id,label:i.nombre}));let V=await we.allPerfiles();const l=V==null?void 0:V.data.perfiles;z.value=l.map(i=>({id:i._id,label:i.descripcion}));let N=await Ue.allMiembrosGet();const H=N==null?void 0:N.data.miembros;if(E.value=H.map(i=>({id:i._id,label:i.nombre})),L.path==="update"){const i=await W.read(Z.params);e.value=i.data,e.value.tipoPersonal=O.filter(J=>J.id===i.data.tipoPersonal)[0],e.value.estado=I.filter(J=>J.id===i.data.estado)[0],e.value.profesion=U((F=i.data)==null?void 0:F.profesion),e.value.idiomas=U((B=i.data)==null?void 0:B.idiomas),e.value.unidadNegocio=U((D=i.data)==null?void 0:D.unidadNegocio),e.value.categoria=U((M=i.data)==null?void 0:M.categoria),e.value.sucursal=U((C=i.data)==null?void 0:C.sucursal),e.value.perfil=U((G=i.data)==null?void 0:G.perfil),e.value.miembro=U((y=i.data)==null?void 0:y.miembro)}});const U=s=>({id:s._id,label:(s==null?void 0:s.nombre)||(s==null?void 0:s.descripcion)}),x=ue(()=>({iDFiscal:{required:Q},nombres:{required:Q},estado:{required:Q}})),A=be(x,e),ee=L.path==="create"?m("message.personal.created.success"):m("message.personal.updated.success"),ae=L.path==="create"?m("message.personal.created.error"):m("message.personal.updated.error"),le=async()=>{await A.value.$validate()?h(e).then(()=>{X.success(ee),_.push("/setup/personal")}).catch(a=>{var d,c;if((d=a.response.data)!=null&&d.msg){X.error(`${ae} ${a.response.data.msg}`);return}if((c=a.response.data)!=null&&c.errors){const p=a.response.data.errors;for(let w of p);}}):console.log("error")};return(s,a)=>(re(),de(ce,{isForm:"",onSubmit:pe(le,["prevent"])},{footer:n(()=>[o(me,{label:s.$t(`message.${L.saveLabel}`),type:"submit",color:"success"},null,8,["label"])]),default:n(()=>{var d,c,p,w,g,S,f,P,V;return[K("div",Se,[o(u,{label:s.$t("message.personal.names"),help:(p=(c=(d=t(A))==null?void 0:d.nombres)==null?void 0:c.$errors[0])==null?void 0:p.$message},{default:n(()=>[o(r,{name:"nombres",modelValue:e.value.nombres,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.nombres=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(u,{label:s.$t("message.personal.surnames")},{default:n(()=>[o(r,{modelValue:e.value.apellidos,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.apellidos=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.idFiscal"),help:(S=(g=(w=t(A))==null?void 0:w.iDFiscal)==null?void 0:g.$errors[0])==null?void 0:S.$message},{default:n(()=>[o(r,{modelValue:e.value.iDFiscal,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.iDFiscal=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(u,{label:s.$t("message.personal.phone")},{default:n(()=>[o(r,{modelValue:e.value.telefono,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.telefono=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.email")},{default:n(()=>[o(r,{modelValue:e.value.email,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.email=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.profession")},{default:n(()=>[o(r,{modelValue:e.value.profesion,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.profesion=l),icon:t(v),options:t(R)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.languages")},{default:n(()=>[o(r,{modelValue:e.value.idiomas,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.idiomas=l),icon:t(v),options:t(k)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.postgraduate")},{default:n(()=>[o(r,{modelValue:e.value.postgrado,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.postgrado=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.businessUnit")},{default:n(()=>[o(r,{modelValue:e.value.unidadNegocio,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.unidadNegocio=l),icon:t(v),options:t(T)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.category")},{default:n(()=>[o(r,{modelValue:e.value.categoria,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.categoria=l),icon:t(v),options:t(j)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.branch")},{default:n(()=>[o(r,{modelValue:e.value.sucursal,"onUpdate:modelValue":a[10]||(a[10]=l=>e.value.sucursal=l),icon:t(v),options:t(q)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.profile")},{default:n(()=>[o(r,{modelValue:e.value.perfil,"onUpdate:modelValue":a[11]||(a[11]=l=>e.value.perfil=l),icon:t(v),options:t(z)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.user")},{default:n(()=>[o(r,{modelValue:e.value.usuarioAcceso,"onUpdate:modelValue":a[12]||(a[12]=l=>e.value.usuarioAcceso=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.password")},{default:n(()=>[o(r,{modelValue:e.value.claveAcceso,"onUpdate:modelValue":a[13]||(a[13]=l=>e.value.claveAcceso=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.status"),help:(V=(P=(f=t(A))==null?void 0:f.estado)==null?void 0:P.$errors[0])==null?void 0:V.$message},{default:n(()=>[o(r,{modelValue:e.value.estado,"onUpdate:modelValue":a[14]||(a[14]=l=>e.value.estado=l),icon:t(v),options:I},null,8,["modelValue","icon"])]),_:1},8,["label","help"])]),K("div",Pe,[o(u,{label:s.$t("message.personal.membership")},{default:n(()=>[o(r,{modelValue:e.value.miembro,"onUpdate:modelValue":a[15]||(a[15]=l=>e.value.miembro=l),icon:t(v),options:t(E)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(u,{label:s.$t("message.personal.typePersonnel")},{default:n(()=>[o(r,{modelValue:e.value.tipoPersonal,"onUpdate:modelValue":a[16]||(a[16]=l=>e.value.tipoPersonal=l),icon:t(v),options:O},null,8,["modelValue","icon"])]),_:1},8,["label"])]),K("div",Le,[o(u,{label:s.$t("message.personal.address")},{default:n(()=>[o(r,{type:"textarea",modelValue:e.value.direccion,"onUpdate:modelValue":a[17]||(a[17]=l=>e.value.direccion=l),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"])])]}),_:1},8,["onSubmit"]))}};export{Oe as _};
