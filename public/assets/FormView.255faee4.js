import{q as me,af as re,ag as ce,as as pe,a9 as be,y as g,I as ve,at as ge,o as fe,c as Ve,w as n,P as k,a as t,d as Ce,ai as N,j as v,B as u,u as s,C as m,au as $e,aw as w,av as f,z as _e,g as ye,al as we,am as Se}from"./index.94f69dfc.js";import{r as R,m as Ue,u as Fe}from"./index.esm.8eaf8d5b.js";import{c as Le}from"./cities.service.6e8d35a5.js";import{a as Be}from"./allies.service.cf99e6fe.js";import{c as Me}from"./cargos.service.2a060ea0.js";import{s as Oe}from"./states.services.447377dd.js";import{m as q}from"./member.service.cf66150f.js";import{T as he}from"./TabsComponent.fc2f5ba5.js";import{c as De}from"./countries.service.e775474b.js";import{c as Ie}from"./currencies.service.ca8bc8cc.js";const Te=U=>(we("data-v-53dd11cf"),U=U(),Se(),U),je={class:"container mx-auto"},Pe={class:"p-1 mt-0 bg-white border"},We={class:"grid md:grid-cols-3 gap-3"},Ye={class:"grid md:grid-cols-2 gap-2"},ke={class:"grid md:grid-cols-3 gap-3"},Ne={class:"grid md:grid-cols-3 gap-3"},Re={class:"grid md:grid-cols-1 gap-1"},qe=Te(()=>v("div",null,null,-1)),Ae={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(U){const C=U,{t:b}=re(),A=ce(),J=pe(),K=be();g([]);let O=g([]),F=g([]),L=g([]),h=g([]),Q=g([]),D=g([]);const B=g(0),X=o=>{B.value=o},Z=[{title:"Membresia"},{title:"Contacto"}],I=[{id:1,label:b("message.cargo.statuses.active")},{id:0,label:b("message.cargo.statuses.inactive")},{id:2,label:b("message.cargo.statuses.deleted")}],T=[{id:1,label:b("message.member.administrative_contacts")},{id:2,label:b("message.member.technology_contacts")}],x=[{id:1,label:b("message.member.yes")},{id:2,label:b("message.member.no")}];g({date:"DD-MM-YYYY",month:"MMM"});const a=g({_id:"",aliado:D.value,codigo:"00",nombre:"",iDFiscal:"",ejercicioFiscal:"",pais:O.value,state:F.value,ciudad:L.value,calle:"",paginaWeb:"",tipoContacto:T[0],nombreContact:"",apellidoContact:"",cargo:h.value,telefonoOfic:"",telefonoCelu:"",correoContact:"",estado:I[0]}),ee=ve(()=>({codigo:{required:R,maxLength:Ue(3)},nombre:{required:R},iDFiscal:{required:R}})),M=Fe(ee,a);ge(async()=>{var $;let o=await De.index();const e=(o==null?void 0:o.paises)||[];O.value=e.map(d=>({id:d._id,label:d.nombre}));let r=await Me.allCargos();const i=r==null?void 0:r.data.cargos;h.value=i.map(d=>({id:d._id,label:d.nombre}));let c=await Be.allAliadosGet();const p=c==null?void 0:c.data.aliados;D.value=p.map(d=>({id:d._id,label:d.nombre}));let V=await Ie.allCurrencies();const S=V==null?void 0:V.data.monedas;if(Q.value=S.map(d=>({id:d._id,label:d.nombre})),console.log(p),C.path==="update"){const d=await q.read(J.params);a.value=d.data;const{cargo:_,aliado:l,moneda:G,estado:P,tipoContacto:W,creacion:Y}=d.data;a.value.cargo={id:_._id,label:_.nombre},a.value.aliado={id:l._id,label:l.nombre},a.value.pais=j(($=d.data)==null?void 0:$.pais),a.value.estado=I.filter(y=>y.id===P)[0],a.value.tipoContacto=T.filter(y=>y.id===W)[0],a.value.creacion=x.filter(y=>y.id===Y)[0],E(a.value.pais,d.data)}});const j=o=>({id:o._id,label:o.nombre}),E=(o,e={})=>{const{id:r}=o;L.value=[],F.value=[],ae(r).then(i=>{const c=(i==null?void 0:i.estados)||[];F.value=c.map(p=>({id:p._id,label:p.nombre})),C.path==="update"&&(a.value.state=j(e==null?void 0:e.state),z(a.value.state,e==null?void 0:e.ciudad))}).catch(i=>{console.log(i)})},ae=async o=>await Oe.estadosByPais(o),z=(o,e={})=>{const{id:r}=o;le(r).then(i=>{const c=(i==null?void 0:i.ciudades)||[];L.value=c.map(p=>({id:p._id,label:p.nombre})),C.path==="update"&&(a.value.ciudad=j(e))}).catch(i=>{console.log(i)})},le=async o=>await Le.ciudadesByEstados(o),oe=o=>{const{_id:e,aliado:r,codigo:i,nombre:c,iDFiscal:p,ejercicioFiscal:V,pais:S,state:$,ciudad:d,calle:_,paginaWeb:l,tipoContacto:G,nombreContact:P,apellidoContact:W,cargo:Y,telefonoOfic:y,telefonoCelu:de,correoContact:ne,estado:ue}=o.value,H={_id:e,aliado:r.id,codigo:i,nombre:c,iDFiscal:p,ejercicioFiscal:V,pais:S.id,state:$.id,ciudad:d.id,calle:_,paginaWeb:l,tipoContacto:G.id,nombreContact:P,apellidoContact:W,cargo:Y.id,telefonoOfic:y,telefonoCelu:de,correoContact:ne,estado:ue.id};return C.path==="create"?q.create(H):q.update(H)},te=C.path==="create"?b("message.member.created.success"):b("message.member.updated.success"),se=C.path==="create"?b("message.member.created.error"):b("message.member.updated.error"),ie=async()=>{await M.value.$validate()?oe(a).then(()=>{A.success(te),K.push("/setup/memberships")}).catch(e=>{var r,i,c;if((i=(r=e.response)==null?void 0:r.data)!=null&&i.msg){A.error(`${se} ${e.response.data.msg}`);return}if((c=e.response.data)!=null&&c.errors){const p=e.response.data.errors;for(let V of p);}}):console.log("error")};return(o,e)=>(fe(),Ve(ye,{isForm:"",onSubmit:_e(ie,["prevent"])},{footer:n(()=>[k(t(Ce,{label:o.$t(`message.${C.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),[[N,B.value===1]])]),default:n(()=>[v("div",null,[v("div",je,[t(he,{tabs:Z,onTabClick:X},{default:n(()=>{var r,i,c,p,V,S,$,d,_;return[v("div",Pe,[k(v("div",null,[v("div",We,[t(u,{label:o.$t("message.member.code"),help:(c=(i=(r=s(M))==null?void 0:r.codigo)==null?void 0:i.$errors[0])==null?void 0:c.$message},{default:n(()=>[t(m,{name:"codigo",modelValue:a.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.codigo=l),icon:s($e)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),t(u,{label:o.$t("message.member.ally")},{default:n(()=>[t(m,{modelValue:a.value.aliado,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.aliado=l),icon:s(w),options:s(D)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.name"),help:(S=(V=(p=s(M))==null?void 0:p.nombre)==null?void 0:V.$errors[0])==null?void 0:S.$message},{default:n(()=>[t(m,{modelValue:a.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.nombre=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),t(u,{label:o.$t("message.member.idFiscal"),help:(_=(d=($=s(M))==null?void 0:$.iDFiscal)==null?void 0:d.$errors[0])==null?void 0:_.$message},{default:n(()=>[t(m,{modelValue:a.value.iDFiscal,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.iDFiscal=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),t(u,{label:o.$t("message.member.f\xEDscal_year")},{default:n(()=>[t(m,{modelValue:a.value.ejercicioFiscal,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.ejercicioFiscal=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.country")},{default:n(()=>[t(m,{modelValue:a.value.pais,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.pais=l),icon:s(w),options:s(O),onOnSelectChange:E},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.state")},{default:n(()=>[t(m,{modelValue:a.value.state,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.state=l),icon:s(w),options:s(F),onOnSelectChange:z},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.city")},{default:n(()=>[t(m,{modelValue:a.value.ciudad,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.ciudad=l),icon:s(w),options:s(L)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.street")},{default:n(()=>[t(m,{modelValue:a.value.calle,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.calle=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),v("div",Ye,[t(u,{label:o.$t("message.member.paginaWeb")},{default:n(()=>[t(m,{modelValue:a.value.paginaWeb,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.paginaWeb=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.status")},{default:n(()=>[t(m,{modelValue:a.value.estado,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.estado=l),icon:s(w),options:I},null,8,["modelValue","icon"])]),_:1},8,["label"])])],512),[[N,B.value===0]]),k(v("div",null,[v("div",ke,[t(u,{label:o.$t("message.member.type_contacts")},{default:n(()=>[t(m,{modelValue:a.value.tipoContacto,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.tipoContacto=l),icon:s(w),options:T},null,8,["modelValue","icon"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.name")},{default:n(()=>[t(m,{modelValue:a.value.nombreContact,"onUpdate:modelValue":e[12]||(e[12]=l=>a.value.nombreContact=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.lastName")},{default:n(()=>[t(m,{modelValue:a.value.apellidoContact,"onUpdate:modelValue":e[13]||(e[13]=l=>a.value.apellidoContact=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),v("div",Ne,[t(u,{label:o.$t("message.member.cargo")},{default:n(()=>[t(m,{modelValue:a.value.cargo,"onUpdate:modelValue":e[14]||(e[14]=l=>a.value.cargo=l),icon:s(w),options:s(h)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.officePhone")},{default:n(()=>[t(m,{modelValue:a.value.telefonoOfic,"onUpdate:modelValue":e[15]||(e[15]=l=>a.value.telefonoOfic=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"]),t(u,{label:o.$t("message.member.movilPhone")},{default:n(()=>[t(m,{modelValue:a.value.telefonoCelu,"onUpdate:modelValue":e[16]||(e[16]=l=>a.value.telefonoCelu=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),v("div",Re,[t(u,{label:o.$t("message.member.email")},{default:n(()=>[t(m,{modelValue:a.value.correoContact,"onUpdate:modelValue":e[17]||(e[17]=l=>a.value.correoContact=l),icon:s(f)},null,8,["modelValue","icon"])]),_:1},8,["label"])])],512),[[N,B.value===1]]),qe])]}),_:1})])])]),_:1},8,["onSubmit"]))}},ea=me(Ae,[["__scopeId","data-v-53dd11cf"]]);export{ea as F};
