import{ag as se,ah as te,aa as le,S as J,I as v,y as f,o as m,r as I,a as i,w as r,j as l,f as w,E as c,$ as G,K as L,L as H,M as q,d as D,u as o,ai as oe,aj as O,ak as ne,al as ie,A as K,c as _,T as ce,x as ue,_ as re,b as Q,ao as de,B as me,Q as W,e as ge,g as z,i as fe,ap as he,aq as ve}from"./index.e27aaed2.js";import{C as pe}from"./CardBoxComponentEmpty.8b08f16b.js";import{a as E}from"./allies.service.894851e6.js";import{_ as $e}from"./FormCheckRadioGroup.84cb26fc.js";import"./FormCheckRadio.44135d25.js";const be=l("th",null,null,-1),_e=["onClick"],ke=["data-label"],ye=["data-label"],Ce=["data-label"],Pe=["data-label"],we={class:"before:hidden lg:w-1 whitespace-nowrap"},De={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Ve={__name:"AllyTable.view",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(V,{emit:b}){const{t:u}=se(),g=te(),T=le(),d=J(),k=v(()=>d.allies.aliados),S=v(()=>d.allies.total),y=f(!1),C=f(!1),U=v(()=>d.allies.perPage),h=v(()=>d.allies.page);f([]);const p=f([]),F=v(()=>k.value),t=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=f(!1),$=e=>{n.value=!n.value,b("sort",e,n.value)},P=v(()=>Math.ceil(S.value/U.value)),A=v(()=>+h.value),B=v(()=>{const e=[];for(let a=0;a<P.value;a++)e.push(a);return e}),M=e=>{b("changePage",e)},N=e=>{T.push({name:"AlliesUpdate",params:{id:e}})},X=e=>p.value=e,R=()=>{const{nombre:e}=p.value;return e},Y=u("message.ally.deleted.success"),Z=async()=>{x().then(()=>{g.success(Y),b("changePage",h.value)}).catch(e=>{var a;g.error(`${u("message.ally.deleted.error")} ${(a=e==null?void 0:e.response)==null?void 0:a.data.msg}`)})},x=()=>{const{_id:e}=p.value;return E.delete(e)},ee=()=>{const{_id:e}=p.value;E.restore(e).then(()=>{g.success(u("message.ally.restore.success")),b("changePage",h.value)}).catch(a=>{var s;g.error(`${u("message.ally.restore.error")} ${(s=a==null?void 0:a.response)==null?void 0:s.data.msg}`)})};return(e,a)=>(m(),I(L,null,[i(G,{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=s=>C.value=s),title:"Please confirm",button:"danger",onConfirm:Z,"has-cancel":""},{default:r(()=>[l("strong",null,[w(c(e.$t("message.ally.deleted.question"))+" ",1),l("b",null,c(R()),1)]),w(" ? ")]),_:1},8,["modelValue"]),i(G,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=s=>y.value=s),title:"Please confirm",onConfirm:ee},{default:r(()=>[l("strong",null,[w(c(e.$t("message.ally.restore.question"))+" ",1),l("b",null,c(R()),1)]),w(" ? ")]),_:1},8,["modelValue"]),l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:a[2]||(a[2]=s=>$("codigo"))},c(e.$t("message.ally.code")),1),l("th",{onClick:a[3]||(a[3]=s=>$("nombre"))},c(e.$t("message.ally.name")),1),l("th",{onClick:a[4]||(a[4]=s=>$("idFiscal"))},c(e.$t("message.ally.id")),1),l("th",{onClick:a[5]||(a[5]=s=>$("estado"))},c(e.$t("message.ally.status")),1),be])]),l("tbody",null,[(m(!0),I(L,null,H(o(F),(s,ae)=>(m(),I("tr",{key:s._id,onClick:j=>X(s)},[l("td",{"data-label":e.$t("message.ally.code")},c(s.codigo),9,ke),l("td",{"data-label":e.$t("message.ally.name")},c(s.nombre),9,ye),l("td",{"data-label":e.$t("message.ally.id")},c(s.iDFiscal),9,Ce),l("td",{"data-label":e.$t("message.ally.status")},c(e.$t(`message.ally.statuses.${t(s.estado)}`)),9,Pe),l("td",we,[i(K,{type:"justify-start lg:justify-end","no-wrap":""},{default:r(()=>[q(i(D,{color:"success",icon:o(oe),messageTooltip:o(u)("message.restore"),small:"",onClick:a[6]||(a[6]=j=>y.value=!0)},null,8,["icon","messageTooltip"]),[[O,V.checkDelete&&s.estado===2]]),q(i(D,{color:"info",icon:o(ne),messageTooltip:o(u)("message.edit"),small:"",onClick:j=>N(s._id)},null,8,["icon","messageTooltip","onClick"]),[[O,!V.checkDelete&&s.estado!==2]]),q(i(D,{color:"danger",icon:o(ie),messageTooltip:o(u)("message.delete"),small:"",onClick:a[7]||(a[7]=j=>C.value=!0)},null,8,["icon","messageTooltip"]),[[O,!V.checkDelete&&s.estado!==2]])]),_:2},1024)])],8,_e))),128))])]),l("div",De,[i(ce,null,{default:r(()=>[i(K,null,{default:r(()=>[(m(!0),I(L,null,H(o(B),s=>(m(),_(D,{key:s,active:s===o(h)-1,label:s+1,color:s===o(h)?"lightDark":"whiteDark",small:"",onClick:ae=>M(s+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),l("small",null,"Page "+c(o(A))+" of "+c(o(P)),1)]),_:1})])],64))}},Ie={__name:"IndexView",setup(V){const b=f([{name:"Inicio"}]),u=J(),g=f(1),T=f(10),d=ue({switch:[]}),k=t=>{E.index(t).then(n=>{u.allies=n,g.value=n.page,T.value=n.perPage})};k({page:g.value});const S=f(!1),y=()=>{p({page:g.value}),S.value=d.switch.length!==0},C=t=>{p({page:t})},U=(t,n)=>{F({sortBy:t,sortDesc:n})},h=t=>{E.getDelete(t).then(n=>{u.allies=n,g.value=n.page,T.value=n.perPage})},p=t=>{d.switch.length===0?k({page:t}):h({page:t})},F=t=>{d.switch.length===0?k(t):h(t)};return(t,n)=>(m(),_(re,null,{default:r(()=>[i(fe,null,{default:r(()=>{var $,P,A,B,M;return[i(Q,{icon:o(he),title:t.$t("message.ally.allies")},{default:r(()=>[i(D,{to:{name:"AlliesCreate"},icon:o(ve),label:t.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),i(de,{items:b.value},null,8,["items"]),i(me,{label:""},{default:r(()=>[i($e,{modelValue:d.switch,"onUpdate:modelValue":n[0]||(n[0]=N=>d.switch=N),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:y},null,8,["modelValue"])]),_:1}),($=o(u))!=null&&$.allies?W("",!0):(m(),_(Q,{key:0,icon:t.mdiTableOff,title:"Empty variation"},null,8,["icon"])),(P=o(u))!=null&&P.allies?W("",!0):(m(),_(ge,{key:1,color:"danger",icon:t.mdiTableOff},{default:r(()=>[l("b",null,c(t.$t("message.empty_table"))+".",1),w(" When there's nothing to show ")]),_:1},8,["icon"])),(M=(B=(A=o(u))==null?void 0:A.allies)==null?void 0:B.aliados)!=null&&M.length?(m(),_(z,{key:2,class:"mb-6","has-table":""},{default:r(()=>[i(Ve,{checkDelete:S.value,onChangePage:C,onSort:U},null,8,["checkDelete"])]),_:1})):(m(),_(z,{key:3},{default:r(()=>[i(pe)]),_:1}))]}),_:1})]),_:1}))}};export{Ie as default};
