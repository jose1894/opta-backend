import{q as W,ag as X,ah as Y,at as Z,aa as ee,y as w,I as ae,au as se,o as te,c as oe,w as r,j as g,a as o,d as E,B as m,u as i,C as p,av as le,aw as N,ax as S,z as ie,g as ne}from"./index.e27aaed2.js";import{r as U,m as de,u as ue}from"./index.esm.6263d8b1.js";import{c as re}from"./cities.service.f962d969.js";import{s as ce}from"./states.services.92a25f7c.js";import{c as me}from"./countries.service.6413becf.js";import{b as F}from"./branches.service.3487c96a.js";const pe={class:"container mx-auto"},be={class:"grid md:grid-cols-3 gap-3"},ge={class:"grid md:grid-cols-2 gap-2"},ve={class:"grid md:grid-cols-2 gap-2"},fe={style:{display:"flex","justify-content":"space-between"}},he={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(P){const c=P,{t:b}=X(),M=Y(),T=Z(),O=ee(),B=[{id:1,label:b("message.branch.statuses.active")},{id:0,label:b("message.branch.statuses.inactive")}];let C=w([]),V=w([]),_=w([]);const t=w({_id:"",codigo:"00",nombre:"",siglas:"",pais:C.value,state:V.value,ciudad:_.value,estado:B[0]}),z=ae(()=>({codigo:{required:U,maxLength:de(3)},nombre:{required:U},siglas:{required:U}})),v=ue(z,t);se(async()=>{var l;let a=await me.index();const e=(a==null?void 0:a.paises)||[];if(C.value=e.map(s=>({id:s._id,label:s.nombre})),c.path==="update"){const s=await F.read(T.params);t.value=s.data,t.value.pais=L((l=s.data)==null?void 0:l.pais),k(t.value.pais,s.data),t.value.estado=B.filter(n=>n.id===s.data.estado)[0]}});const L=a=>({id:a._id,label:a.nombre}),k=(a,e={})=>{const{id:l}=a;_.value=[],V.value=[],A(l).then(s=>{const n=(s==null?void 0:s.estados)||[];V.value=n.map(u=>({id:u._id,label:u.nombre})),c.path==="update"&&(t.value.state=L(e==null?void 0:e.state),x(t.value.state,e==null?void 0:e.ciudad))}).catch(s=>{console.log(s)})},A=async a=>await ce.estadosByPais(a),x=(a,e={})=>{const{id:l}=a;D(l).then(s=>{const n=(s==null?void 0:s.ciudades)||[];_.value=n.map(u=>({id:u._id,label:u.nombre})),c.path==="update"&&(t.value.ciudad=L(e))}).catch(s=>{console.log(s)})},D=async a=>await re.ciudadesByEstados(a),G=a=>{const{_id:e,codigo:l,nombre:s,siglas:n,pais:u,state:f,ciudad:$,estado:y}=a.value,h={_id:e,codigo:l,nombre:s,siglas:n,pais:u.id,state:f.id,ciudad:$.id,estado:y.id};return c.path==="create"?F.create(h):F.update(h)},H=c.path==="create"?b("message.branch.created.success"):b("message.branch.updated.success"),J=c.path==="create"?b("message.branch.created.error"):b("message.branch.updated.error"),K=async()=>{await v.value.$validate()?G(t).then(()=>{M.success(H),O.push("/setup/branches")}).catch(e=>{var l,s,n;if((s=(l=e.response)==null?void 0:l.data)!=null&&s.msg){M.error(`${J} ${e.response.data.msg}`);return}if((n=e.response.data)!=null&&n.errors){const u=e.response.data.errors;for(let f of u);}}):console.log("error")},Q=()=>O.push("/setup/branches");return(a,e)=>(te(),oe(ne,{isForm:"",onSubmit:ie(K,["prevent"])},{footer:r(()=>[g("div",fe,[o(E,{label:a.$t(`message.${c.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),o(E,{label:a.$t("message.return"),color:"info",onClick:e[7]||(e[7]=l=>Q())},null,8,["label"])])]),default:r(()=>{var l,s,n,u,f,$,y,h,I,R,j,q;return[g("div",null,[g("div",pe,[g("div",be,[o(m,{label:a.$t("message.branch.code"),help:(n=(s=(l=i(v))==null?void 0:l.codigo)==null?void 0:s.$errors[0])==null?void 0:n.$message},{default:r(()=>[o(p,{name:"codigo",modelValue:t.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=d=>t.value.codigo=d),icon:i(le)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(m,{label:a.$t("message.branch.name"),help:($=(f=(u=i(v))==null?void 0:u.nombre)==null?void 0:f.$errors[0])==null?void 0:$.$message},{default:r(()=>[o(p,{modelValue:t.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value.nombre=d),icon:i(N)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),o(m,{label:a.$t("message.branch.acronyms"),help:(I=(h=(y=i(v))==null?void 0:y.siglas)==null?void 0:h.$errors[0])==null?void 0:I.$message},{default:r(()=>[o(p,{modelValue:t.value.siglas,"onUpdate:modelValue":e[2]||(e[2]=d=>t.value.siglas=d),icon:i(N)},null,8,["modelValue","icon"])]),_:1},8,["label","help"])]),g("div",ge,[o(m,{label:a.$t("message.branch.country")},{default:r(()=>[o(p,{modelValue:t.value.pais,"onUpdate:modelValue":e[3]||(e[3]=d=>t.value.pais=d),icon:i(S),options:i(C),onOnSelectChange:k},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(m,{label:a.$t("message.branch.state")},{default:r(()=>[o(p,{modelValue:t.value.state,"onUpdate:modelValue":e[4]||(e[4]=d=>t.value.state=d),icon:i(S),options:i(V),onOnSelectChange:x},null,8,["modelValue","icon","options"])]),_:1},8,["label"])]),g("div",ve,[o(m,{label:a.$t("message.branch.city")},{default:r(()=>[o(p,{modelValue:t.value.ciudad,"onUpdate:modelValue":e[5]||(e[5]=d=>t.value.ciudad=d),icon:i(S),options:i(_)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),o(m,{label:a.$t("message.branch.status"),help:(q=(j=(R=i(v))==null?void 0:R.estado)==null?void 0:j.$errors[0])==null?void 0:q.$message},{default:r(()=>[o(p,{modelValue:t.value.estado,"onUpdate:modelValue":e[6]||(e[6]=d=>t.value.estado=d),icon:i(S),options:B},null,8,["modelValue","icon"])]),_:1},8,["label","help"])])])])]}),_:1},8,["onSubmit"]))}},Be=W(he,[["__scopeId","data-v-de0a7595"]]);export{Be as F};
