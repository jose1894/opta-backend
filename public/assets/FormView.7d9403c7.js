import{ag as K,ah as Q,at as W,aa as X,y as V,au as Y,I as Z,o as ee,c as se,w as u,j as _,a as n,d as q,B as b,u as i,C as f,av as ae,ax as w,aw as te,z as oe,g as le}from"./index.e27aaed2.js";import{r as S,m as ie,u as ne}from"./index.esm.6263d8b1.js";import{s as re}from"./states.services.92a25f7c.js";import{c as B}from"./cities.service.f962d969.js";import{c as de}from"./countries.service.6413becf.js";const ue={class:"grid md:grid-cols-3 gap-4"},ce={class:"grid md:grid-cols-2 gap-4"},me={style:{display:"flex","justify-content":"space-between"}},$e={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(x){const g=x,{t:c}=K(),L=Q(),z=W(),C=X();let y=[{id:1,label:c("message.city.statuses.active")},{id:0,label:c("message.city.statuses.inactive")},{id:2,label:c("message.city.statuses.deleted")}],$=V([]),h=V([]);const a=V({_id:"",codigo:"00",nombre:"",estado:y[0],pais:h.value,state:$.value}),A=s=>{const{_id:e,codigo:l,nombre:o,estado:r,pais:t,state:p}=s.value,v={_id:e,codigo:l,nombre:o,estado:r.id,pais:t.id,state:p.id};return g.path==="create"?B.create(v):B.update(v)};Y(async()=>{var l,o,r;let s=await de.getDelete({estado:1});const e=(s==null?void 0:s.paises)||[];if(console.log(e),h.value=e.map(t=>({id:t._id,label:t.nombre})),g.path==="update"){const t=await B.read(z.params);(l=t.data)!=null&&l.state,a.value=t.data,a.value.estado=y.filter(p=>p.id===t.data.estado)[0],a.value.pais=U((o=t.data)==null?void 0:o.pais),k(a.value.pais,(r=t.data)==null?void 0:r.state)}});const U=s=>({id:s._id,label:s.nombre}),D=Z(()=>({codigo:{required:S,maxLength:ie(3)},nombre:{required:S},estado:{required:S}})),m=ne(D,a),k=(s,e={})=>{const{id:l}=s;$.value=[],E(l).then(o=>{const r=(o==null?void 0:o.estados)||[];$.value=r.map(t=>({id:t._id,label:t.nombre})),g.path==="update"&&(a.value.state=U(e))}).catch(o=>{console.log(o)})},E=async s=>await re.estadosByPais(s),G=g.path==="create"?c("message.city.created.success"):c("message.city.updated.success"),H=async()=>{const s=await m.value.$validate();console.log(s),s?A(a).then(()=>{L.success(G),C.push("/setup/cities")}).catch(e=>{var l,o;if((l=e.response.data)!=null&&l.msg){L.error(`${c("message.city.created.error")} ${e.response.data.msg}`);return}if((o=e.response.data)!=null&&o.errors){const r=e.response.data.errors;for(let t of r);}}):console.log("error")},J=()=>C.push("/setup/cities");return(s,e)=>(ee(),se(le,{isForm:"",onSubmit:oe(H,["prevent"])},{footer:u(()=>[_("div",me,[n(q,{label:s.$t(`message.${g.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),n(q,{label:s.$t("message.return"),color:"info",onClick:e[5]||(e[5]=l=>J())},null,8,["label"])])]),default:u(()=>{var l,o,r,t,p,v,M,O,R,j,F,I,N,P,T;return[_("div",ue,[n(b,{label:s.$t("message.city.code"),help:(r=(o=(l=i(m))==null?void 0:l.codigo)==null?void 0:o.$errors[0])==null?void 0:r.$message},{default:u(()=>[n(f,{name:"codigo",modelValue:a.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=d=>a.value.codigo=d),icon:i(ae)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),n(b,{label:s.$t("message.city.country"),help:(v=(p=(t=i(m))==null?void 0:t.estado)==null?void 0:p.$errors[0])==null?void 0:v.$message},{default:u(()=>[n(f,{modelValue:a.value.pais,"onUpdate:modelValue":e[1]||(e[1]=d=>a.value.pais=d),icon:i(w),options:i(h),onOnSelectChange:k},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"]),n(b,{label:s.$t("message.city.state"),help:(R=(O=(M=i(m))==null?void 0:M.state)==null?void 0:O.$errors[0])==null?void 0:R.$message},{default:u(()=>[n(f,{modelValue:a.value.state,"onUpdate:modelValue":e[2]||(e[2]=d=>a.value.state=d),icon:i(w),options:i($)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"])]),_("div",ce,[n(b,{label:s.$t("message.city.name"),help:(I=(F=(j=i(m))==null?void 0:j.nombre)==null?void 0:F.$errors[0])==null?void 0:I.$message},{default:u(()=>[n(f,{modelValue:a.value.nombre,"onUpdate:modelValue":e[3]||(e[3]=d=>a.value.nombre=d),icon:i(te)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),n(b,{label:s.$t("message.city.status"),help:(T=(P=(N=i(m))==null?void 0:N.estado)==null?void 0:P.$errors[0])==null?void 0:T.$message},{default:u(()=>[n(f,{modelValue:a.value.estado,"onUpdate:modelValue":e[4]||(e[4]=d=>a.value.estado=d),icon:i(w),options:i(y)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"])])]}),_:1},8,["onSubmit"]))}};export{$e as _};
