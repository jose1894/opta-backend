import{q as be,ag as pe,ah as ve,at as ge,aa as fe,y as f,I as Ve,au as $e,o as Ce,c as we,w as i,j as g,M as D,a as l,d as Q,aj as j,B as d,u as t,C as u,av as Ue,ax as S,aw as b,z as ye,g as Se,am as Me,an as Fe}from"./index.e27aaed2.js";import{r as q,m as _e,u as Le}from"./index.esm.6263d8b1.js";import{c as Oe}from"./cities.service.f962d969.js";import{a as Be}from"./allies.service.894851e6.js";import{c as De}from"./cargos.service.90ce512d.js";import{s as je}from"./states.services.92a25f7c.js";import{m as z}from"./member.service.2c2d1fb8.js";import{T as Ie}from"./TabsComponent.f3aa20e8.js";import{c as Te}from"./countries.service.6413becf.js";import{c as We}from"./currencies.service.a7bb4266.js";const ke=F=>(Me("data-v-5cffa399"),F=F(),Fe(),F),Ne={class:"container mx-auto"},Pe={class:"p-1 mt-0 bg-white border"},Re={class:"grid md:grid-cols-3 gap-3"},Ye={class:"grid md:grid-cols-2 gap-2"},Ae={class:"grid md:grid-cols-3 gap-3"},Ee={class:"grid md:grid-cols-3 gap-3"},qe={class:"grid md:grid-cols-1 gap-1"},ze={class:"grid md:grid-cols-3 gap-3"},Ge=ke(()=>g("div",null,null,-1)),he={style:{display:"flex","justify-content":"space-between"}},He={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(F){const C=F,{t:V}=pe(),G=ve(),X=ge(),h=fe();f([]);let I=f([]),L=f([]),O=f([]),T=f([]),Z=f([]),W=f([]);const _=f(0),x=s=>{_.value=s},ee=[{title:"Membresia"},{title:"Contacto"},{title:"Users"}],k=[{id:1,label:V("message.cargo.statuses.active")},{id:0,label:V("message.cargo.statuses.inactive")}],N=[{id:1,label:V("message.member.administrative_contacts")},{id:2,label:V("message.member.technology_contacts")}],ae=[{id:1,label:V("message.member.yes")},{id:2,label:V("message.member.no")}];f({date:"DD-MM-YYYY",month:"MMM"});const r=f({_id:"",firstname:"",lastname:"",username:"",email:"",password:"",avatar:"",role:"ADMIN_ROLE",estadoMembresia:1,google:!1}),o=f({_id:"",aliado:W.value,codigo:"00",nombre:"",iDFiscal:"",ejercicioFiscal:"",pais:I.value,state:L.value,ciudad:O.value,calle:"",paginaWeb:"",tipoContacto:N[0],nombreContact:"",apellidoContact:"",cargo:T.value,telefonoOfic:"",telefonoCelu:"",correoContact:"",estado:k[0]}),le=Ve(()=>({codigo:{required:q,maxLength:_e(3)},nombre:{required:q},iDFiscal:{required:q}})),B=Le(le,o);$e(async()=>{var w;let s=await Te.index();const e=(s==null?void 0:s.paises)||[];I.value=e.map(n=>({id:n._id,label:n.nombre}));let c=await De.allCargos();const m=c==null?void 0:c.data.cargos;T.value=m.map(n=>({id:n._id,label:n.nombre}));let p=await Be.allAliadosGet();const v=p==null?void 0:p.data.aliados;W.value=v.map(n=>({id:n._id,label:n.nombre}));let $=await We.allCurrencies();const M=$==null?void 0:$.data.monedas;if(Z.value=M.map(n=>({id:n._id,label:n.nombre})),console.log(v),C.path==="update"){const n=await z.read(X.params);o.value=n.data.miembro;const{cargo:U,aliado:a,moneda:K,estado:R,tipoContacto:Y,creacion:A}=n.data.miembro;o.value.cargo={id:U._id,label:U.nombre},o.value.aliado={id:a._id,label:a.nombre},o.value.pais=P((w=n.data)==null?void 0:w.miembro.pais),o.value.estado=k.filter(y=>y.id===R)[0],o.value.tipoContacto=N.filter(y=>y.id===Y)[0],o.value.creacion=ae.filter(y=>y.id===A)[0],H(o.value.pais,n.data.miembro),n.data.userMiembro&&(console.log(n.data.userMiembro),r.value=n.data.userMiembro,r.value.password=n.data.password)}});const P=s=>({id:s._id,label:s.nombre}),H=(s,e={})=>{const{id:c}=s;O.value=[],L.value=[],oe(c).then(m=>{const p=(m==null?void 0:m.estados)||[];L.value=p.map(v=>({id:v._id,label:v.nombre})),C.path==="update"&&(o.value.state=P(e==null?void 0:e.state),J(o.value.state,e==null?void 0:e.ciudad))}).catch(m=>{console.log(m)})},oe=async s=>await je.estadosByPais(s),J=(s,e={})=>{const{id:c}=s;se(c).then(m=>{const p=(m==null?void 0:m.ciudades)||[];O.value=p.map(v=>({id:v._id,label:v.nombre})),C.path==="update"&&(o.value.ciudad=P(e))}).catch(m=>{console.log(m)})},se=async s=>await Oe.ciudadesByEstados(s),te=s=>{const{_id:e,aliado:c,codigo:m,nombre:p,iDFiscal:v,ejercicioFiscal:$,pais:M,state:w,ciudad:n,calle:U,paginaWeb:a,tipoContacto:K,nombreContact:R,apellidoContact:Y,cargo:A,telefonoOfic:y,telefonoCelu:me,correoContact:re,estado:ce}=s.value;console.log(r.value);const E={_id:e,aliado:c.id,codigo:m,nombre:p,iDFiscal:v,ejercicioFiscal:$,pais:M.id,state:w.id,ciudad:n.id,calle:U,paginaWeb:a,tipoContacto:K.id,nombreContact:R,apellidoContact:Y,cargo:A.id,telefonoOfic:y,telefonoCelu:me,correoContact:re,membresiaUsuario:r.value,estado:ce.id};return console.log(E),C.path==="create"?z.create(E):z.update(E)},ie=C.path==="create"?V("message.member.created.success"):V("message.member.updated.success"),ne=C.path==="create"?V("message.member.created.error"):V("message.member.updated.error"),de=async()=>{await B.value.$validate()?te(o).then(()=>{G.success(ie),h.push("/setup/memberships")}).catch(e=>{var c,m,p;if((m=(c=e.response)==null?void 0:c.data)!=null&&m.msg){G.error(`${ne} ${e.response.data.msg}`);return}if((p=e.response.data)!=null&&p.errors){const v=e.response.data.errors;for(let $ of v);}}):console.log("error")},ue=()=>h.push("/setup/memberships");return(s,e)=>(Ce(),we(Se,{isForm:"",onSubmit:ye(de,["prevent"])},{footer:i(()=>[g("div",he,[D(l(Q,{label:s.$t(`message.${C.saveLabel}`),type:"submit",color:"success"},null,8,["label"]),[[j,_.value===2]]),l(Q,{label:s.$t("message.return"),color:"info",onClick:e[24]||(e[24]=c=>ue())},null,8,["label"])])]),default:i(()=>[g("div",null,[g("div",Ne,[l(Ie,{tabs:ee,onTabClick:x},{default:i(()=>{var c,m,p,v,$,M,w,n,U;return[g("div",Pe,[D(g("div",null,[g("div",Re,[l(d,{label:s.$t("message.member.code"),help:(p=(m=(c=t(B))==null?void 0:c.codigo)==null?void 0:m.$errors[0])==null?void 0:p.$message},{default:i(()=>[l(u,{name:"codigo",modelValue:o.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.codigo=a),icon:t(Ue)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),l(d,{label:s.$t("message.member.ally")},{default:i(()=>[l(u,{modelValue:o.value.aliado,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.aliado=a),icon:t(S),options:t(W)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.name"),help:(M=($=(v=t(B))==null?void 0:v.nombre)==null?void 0:$.$errors[0])==null?void 0:M.$message},{default:i(()=>[l(u,{modelValue:o.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.nombre=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),l(d,{label:s.$t("message.member.idFiscal"),help:(U=(n=(w=t(B))==null?void 0:w.iDFiscal)==null?void 0:n.$errors[0])==null?void 0:U.$message},{default:i(()=>[l(u,{modelValue:o.value.iDFiscal,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.iDFiscal=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),l(d,{label:s.$t("message.member.f\xEDscal_year")},{default:i(()=>[l(u,{modelValue:o.value.ejercicioFiscal,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.ejercicioFiscal=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.country")},{default:i(()=>[l(u,{modelValue:o.value.pais,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.pais=a),icon:t(S),options:t(I),onOnSelectChange:H},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.state")},{default:i(()=>[l(u,{modelValue:o.value.state,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.state=a),icon:t(S),options:t(L),onOnSelectChange:J},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.city")},{default:i(()=>[l(u,{modelValue:o.value.ciudad,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.ciudad=a),icon:t(S),options:t(O)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.street")},{default:i(()=>[l(u,{modelValue:o.value.calle,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.calle=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),g("div",Ye,[l(d,{label:s.$t("message.member.paginaWeb")},{default:i(()=>[l(u,{modelValue:o.value.paginaWeb,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.paginaWeb=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.status")},{default:i(()=>[l(u,{modelValue:o.value.estado,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.estado=a),icon:t(S),options:k},null,8,["modelValue","icon"])]),_:1},8,["label"])])],512),[[j,_.value===0]]),D(g("div",null,[g("div",Ae,[l(d,{label:s.$t("message.member.type_contacts")},{default:i(()=>[l(u,{modelValue:o.value.tipoContacto,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.tipoContacto=a),icon:t(S),options:N},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.name")},{default:i(()=>[l(u,{modelValue:o.value.nombreContact,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.nombreContact=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.lastName")},{default:i(()=>[l(u,{modelValue:o.value.apellidoContact,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.apellidoContact=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),g("div",Ee,[l(d,{label:s.$t("message.member.cargo")},{default:i(()=>[l(u,{modelValue:o.value.cargo,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.cargo=a),icon:t(S),options:t(T)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.officePhone")},{default:i(()=>[l(u,{modelValue:o.value.telefonoOfic,"onUpdate:modelValue":e[15]||(e[15]=a=>o.value.telefonoOfic=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.member.movilPhone")},{default:i(()=>[l(u,{modelValue:o.value.telefonoCelu,"onUpdate:modelValue":e[16]||(e[16]=a=>o.value.telefonoCelu=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"])]),g("div",qe,[l(d,{label:s.$t("message.member.email")},{default:i(()=>[l(u,{modelValue:o.value.correoContact,"onUpdate:modelValue":e[17]||(e[17]=a=>o.value.correoContact=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"])])],512),[[j,_.value===1]]),D(g("div",null,[g("div",ze,[l(d,{label:s.$t("message.user.firstname")},{default:i(()=>[l(u,{modelValue:r.value.firstname,"onUpdate:modelValue":e[18]||(e[18]=a=>r.value.firstname=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.user.lastname")},{default:i(()=>[l(u,{modelValue:r.value.lastname,"onUpdate:modelValue":e[19]||(e[19]=a=>r.value.lastname=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.user.username")},{default:i(()=>[l(u,{modelValue:r.value.username,"onUpdate:modelValue":e[20]||(e[20]=a=>r.value.username=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.user.email")},{default:i(()=>[l(u,{modelValue:r.value.email,"onUpdate:modelValue":e[21]||(e[21]=a=>r.value.email=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.user.password")},{default:i(()=>[l(u,{modelValue:r.value.password,"onUpdate:modelValue":e[22]||(e[22]=a=>r.value.password=a),icon:t(b)},null,8,["modelValue","icon"])]),_:1},8,["label"]),l(d,{label:s.$t("message.user.role")},{default:i(()=>[l(u,{modelValue:r.value.role,"onUpdate:modelValue":e[23]||(e[23]=a=>r.value.role=a),icon:t(b),readonly:"true"},null,8,["modelValue","icon"])]),_:1},8,["label"])])],512),[[j,_.value===2]]),Ge])]}),_:1})])])]),_:1},8,["onSubmit"]))}},sa=be(He,[["__scopeId","data-v-5cffa399"]]);export{sa as F};
