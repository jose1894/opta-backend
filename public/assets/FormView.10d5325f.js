import{af as X,ag as Y,as as Z,a9 as ee,x as se,y as _,I,at as ae,o as L,c as R,w as c,a as i,d as oe,j as V,B as g,u as l,C as $,au as te,av as le,aw as j,r as ie,J as re,K as ne,z as ce,g as de}from"./index.cb093d8e.js";import{r as P,m as ue,u as me}from"./index.esm.25e21f11.js";import{p as y}from"./profiles.service.3d0baa48.js";import{i as pe}from"./itemsMenu.service.0b5d8a26.js";import{_ as fe}from"./FormCheckRadioGroup.d9d00b52.js";import{p as ge}from"./profileActions.service.6523c0ce.js";const ve={class:"grid md:grid-cols-2 gap-2"},be=V("div",{class:"grid md:grid-cols-1"},[V("h4",{class:"text-xl"},"Acciones del perfil")],-1),he={class:"grid md:grid-cols-2 gap-2"},we={__name:"FormView",props:{path:"",saveLabel:""},setup(E){const m=E,{t:n}=X(),B=Y(),N=Z(),O=ee();let d=[];const v=se({checkbox:[]}),x=[{id:1,label:n("message.profiles.statuses.active")},{id:0,label:n("message.profiles.statuses.inactive")},{id:2,label:n("message.profiles.statuses.deleted")}];let k=_([]),M=_([]),q=_([]);const w=I(()=>M.value),t=_({_id:"",codigo:"00",descripcion:"",menu:k.value,accionesPerfil:q.value,estado:x[0]}),z=s=>{const{_id:e,codigo:o,descripcion:a,menu:u,accionesPerfil:p,estado:h}=s.value,f={_id:e,codigo:o,descripcion:a,menu:u.id,accionesPerfil:p,estado:h.id};return m.path==="create"?y.create(f):y.update(f)};ae(async()=>{var s;if(D(),J(),m.path==="update"){const e=await y.read(N.params);t.value=e.data,t.value.estado=x.filter(a=>a.id===e.data.estado)[0];const o=(s=e.data)==null?void 0:s.accionesPerfil;d=o.map(a=>({_id:a._id})),v.checkbox=o.map(a=>a._id),console.log(v)}});const D=async()=>{let s=await pe.allMenu();const e=s==null?void 0:s.data.menu;k.value=e.map(o=>({id:o._id,label:o.descripcion}))},J=async()=>{let s=await ge.allAccionesPerfiles();const e=s==null?void 0:s.data.accionesPerfiles;console.log(e),M.value=K(e),console.log(M)},K=s=>s.map(({_id:e,descripcion:o})=>({[e]:o})),T=I(()=>({codigo:{required:P,maxLength:ue(3)},descripcion:{required:P},estado:{required:P}})),b=me(T,t),G=m.path==="create"?n("message.profiles.created.success"):n("message.profiles.updated.success"),H=m.path==="create"?n("message.profiles.created.error"):n("message.profiles.updated.error"),Q=async()=>{await b.value.$validate()?z(t).then(()=>{B.success(G),O.push("/setup/profiles")}).catch(e=>{var o,a;if((o=e.response.data)!=null&&o.msg){B.error(`${H} ${e.response.data.msg}`);return}if((a=e.response.data)!=null&&a.errors){const u=e.response.data.errors;for(let p of u);}}):console.log("error")},W=s=>{const e=Object.keys(s)[0];d.filter(a=>a._id===e).length===0?d.push({_id:e}):d=d.filter(a=>a._id!==e),t.value.accionesPerfil=d,console.log(t.value)};return(s,e)=>(L(),R(de,{isForm:"",onSubmit:ce(Q,["prevent"])},{footer:c(()=>[i(oe,{label:s.$t(`message.${m.saveLabel}`),type:"submit",color:"success"},null,8,["label"])]),default:c(()=>{var o,a,u,p,h,f,C,A,S;return[V("div",ve,[i(g,{label:s.$t("message.profiles.code"),help:(u=(a=(o=l(b))==null?void 0:o.codigo)==null?void 0:a.$errors[0])==null?void 0:u.$message},{default:c(()=>[i($,{name:"codigo",modelValue:t.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.codigo=r),icon:l(te)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),i(g,{label:s.$t("message.profiles.description"),help:(f=(h=(p=l(b))==null?void 0:p.descripcion)==null?void 0:h.$errors[0])==null?void 0:f.$message},{default:c(()=>[i($,{modelValue:t.value.descripcion,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.descripcion=r),icon:l(le)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),i(g,{label:s.$t("message.profiles.menu")},{default:c(()=>[i($,{modelValue:t.value.menu,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.menu=r),icon:l(j),options:l(k)},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),i(g,{label:s.$t("message.profiles.status"),help:(S=(A=(C=l(b))==null?void 0:C.estado)==null?void 0:A.$errors[0])==null?void 0:S.$message},{default:c(()=>[i($,{modelValue:t.value.estado,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.estado=r),icon:l(j),options:x},null,8,["modelValue","icon"])]),_:1},8,["label","help"])]),be,V("div",he,[(L(!0),ie(re,null,ne(l(w),(r,U)=>(L(),R(g,{label:""},{default:c(()=>[i(fe,{modelValue:v.checkbox,"onUpdate:modelValue":e[4]||(e[4]=F=>v.checkbox=F),name:"sample-checkbox",options:l(w)[U],onChange:F=>W(l(w)[U])},null,8,["modelValue","options","onChange"])]),_:2},1024))),256))])]}),_:1},8,["onSubmit"]))}};export{we as _};
