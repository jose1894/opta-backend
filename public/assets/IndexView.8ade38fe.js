import{af as te,ag as le,a9 as ne,R as Q,I as h,y as p,o as m,r as U,a as r,w as i,j as l,f as y,E as c,Z as G,J as L,K as H,P as O,d as D,u as o,ah as oe,ai as R,aj as re,ak as ce,A as J,c as k,S as ie,x as ue,_ as de,b as K,an as me,B as ge,O as W,e as pe,g as Z,i as fe,ao as he,ap as ve,p as z}from"./index.94f69dfc.js";import{C as $e}from"./CardBoxComponentEmpty.c052dd4c.js";import{p as N}from"./personal.service.551a9226.js";import{_ as be}from"./FormCheckRadioGroup.7dc4317c.js";import"./FormCheckRadio.7aa78bc3.js";const _e=["onClick"],ke=["data-label"],Pe=["data-label"],Ce=["data-label"],we={class:"before:hidden lg:w-1 whitespace-nowrap"},ye={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},De={__name:"PersonalTable",props:{checkable:Boolean,checkDelete:Boolean},emits:["changePage","confirm","sort"],setup(V,{emit:$}){const{t:u}=te(),g=le(),S=ne(),d=Q(),b=h(()=>{var e;return(e=d.personal)==null?void 0:e.personas}),B=h(()=>d.personal.total);console.log(b);const P=p(!1),C=p(!1),T=h(()=>d.personal.perPage),f=h(()=>d.personal.page);p([]);const v=p([]),j=h(()=>b.value),t=(e="")=>({0:"inactive",1:"active",2:"deleted"})[e],n=p(!1),_=e=>{n.value=!n.value,$("sort",e,n.value)},w=h(()=>Math.ceil(B.value/T.value)),I=h(()=>+f.value),M=h(()=>{const e=[];for(let a=0;a<w.value;a++)e.push(a);return e}),E=e=>{$("changePage",e)},A=e=>{S.push({name:"PersonalesUpdate",params:{id:e}})},X=e=>v.value=e,q=()=>{const{nombres:e,apellidos:a}=v.value;return e+a},Y=u("message.personal.deleted.success"),x=async()=>{ee().then(()=>{g.success(Y),$("changePage",f.value)}).catch(e=>{var a;g.error(`${u("message.personal.deleted.error")} ${(a=e==null?void 0:e.response)==null?void 0:a.data.msg}`)})},ee=()=>{const{_id:e}=v.value;return N.delete(e)},ae=()=>{const{_id:e}=v.value;N.restore(e).then(()=>{g.success(u("message.personal.restore.success")),$("changePage",f.value)}).catch(a=>{var s;g.error(`${u("message.personal.restore.error")} ${(s=a==null?void 0:a.response)==null?void 0:s.data.msg}`)})};return(e,a)=>(m(),U(L,null,[r(G,{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=s=>C.value=s),title:"Please confirm",button:"danger",onConfirm:x,"has-cancel":""},{default:i(()=>[l("strong",null,[y(c(e.$t("message.personal.deleted.question"))+" ",1),l("b",null,c(q()),1)]),y(" ? ")]),_:1},8,["modelValue"]),r(G,{modelValue:P.value,"onUpdate:modelValue":a[1]||(a[1]=s=>P.value=s),title:"Please confirm",onConfirm:ae},{default:i(()=>[l("strong",null,[y(c(e.$t("message.personal.restore.question"))+" ",1),l("b",null,c(q()),1)]),y(" ? ")]),_:1},8,["modelValue"]),l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:a[2]||(a[2]=s=>_("nombres"))},c(e.$t("message.personal.names")),1),l("th",{onClick:a[3]||(a[3]=s=>_("apellidos"))},c(e.$t("message.personal.surnames")),1),l("th",{onClick:a[4]||(a[4]=s=>_("estado"))},c(e.$t("message.personal.status")),1)])]),l("tbody",null,[(m(!0),U(L,null,H(o(j),(s,se)=>(m(),U("tr",{key:s._id,onClick:F=>X(s)},[l("td",{"data-label":e.$t("message.personal.names")},c(s.nombres),9,ke),l("td",{"data-label":e.$t("message.personal.surnames")},c(s.apellidos),9,Pe),l("td",{"data-label":e.$t("message.personal.status")},c(e.$t(`message.personal.statuses.${t(s.estado)}`)),9,Ce),l("td",we,[r(J,{type:"justify-start lg:justify-end","no-wrap":""},{default:i(()=>[O(r(D,{color:"success",icon:o(oe),small:"",onClick:a[5]||(a[5]=F=>P.value=!0)},null,8,["icon"]),[[R,V.checkDelete&&s.estado===2]]),O(r(D,{color:"info",icon:o(re),small:"",onClick:F=>A(s._id)},null,8,["icon","onClick"]),[[R,!V.checkDelete&&s.estado!==2]]),O(r(D,{color:"danger",icon:o(ce),small:"",onClick:a[6]||(a[6]=F=>C.value=!0)},null,8,["icon"]),[[R,!V.checkDelete&&s.estado!==2]])]),_:2},1024)])],8,_e))),128))])]),l("div",ye,[r(ie,null,{default:i(()=>[r(J,null,{default:i(()=>[(m(!0),U(L,null,H(o(M),s=>(m(),k(D,{key:s,active:s===o(f)-1,label:s+1,color:s===o(f)?"lightDark":"whiteDark",small:"",onClick:se=>E(s+1)},null,8,["active","label","color","onClick"]))),128))]),_:1}),l("small",null,"Page "+c(o(I))+" of "+c(o(w)),1)]),_:1})])],64))}},Ee={__name:"IndexView",setup(V){const $=p([{name:"Inicio"}]),u=Q(),g=p(1),S=p(10),d=ue({switch:[]}),b=t=>{N.index(t).then(n=>{u.personal=n,g.value=n.page,S.value=n.perPage})};b({page:g.value});const B=p(!1),P=()=>{v({page:g.value}),B.value=d.switch.length!==0},C=t=>{v({page:t})},T=(t,n)=>{j({sortBy:t,sortDesc:n})},f=t=>{N.getDelete(t).then(n=>{u.personal=n,g.value=n.page,S.value=n.perPage})},v=t=>{d.switch.length===0?b({page:t}):f({page:t})},j=t=>{d.switch.length===0?b(t):f(t)};return(t,n)=>(m(),k(de,null,{default:i(()=>[r(fe,null,{default:i(()=>{var _,w,I,M,E;return[r(K,{icon:o(he),title:t.$t("message.personal.personal")},{default:i(()=>[r(D,{to:"personal/create",icon:o(ve),label:t.$t("message.add_new"),color:"success",small:""},null,8,["icon","label"])]),_:1},8,["icon","title"]),r(me,{items:$.value},null,8,["items"]),r(ge,{label:""},{default:i(()=>[r(be,{modelValue:d.switch,"onUpdate:modelValue":n[0]||(n[0]=A=>d.switch=A),name:"sample-switch",type:"switch",options:{one:"Mostrar registros eliminados"},onChange:P},null,8,["modelValue"])]),_:1}),(_=o(u))!=null&&_.personal?W("",!0):(m(),k(K,{key:0,icon:o(z),title:"Empty variation"},null,8,["icon"])),(w=o(u))!=null&&w.personal?W("",!0):(m(),k(pe,{key:1,color:"danger",icon:o(z)},{default:i(()=>[l("b",null,c(t.$t("message.empty_table"))+".",1),y(" When there's nothing to show ")]),_:1},8,["icon"])),(E=(M=(I=o(u))==null?void 0:I.personal)==null?void 0:M.personas)!=null&&E.length?(m(),k(Z,{key:2,class:"mb-6","has-table":""},{default:i(()=>[r(De,{checkDelete:B.value,onChangePage:C,onSort:T},null,8,["checkDelete"])]),_:1})):(m(),k(Z,{key:3},{default:i(()=>[r($e)]),_:1}))]}),_:1})]),_:1}))}};export{Ee as default};
