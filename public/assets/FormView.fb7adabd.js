import{q as D,af as E,ag as H,as as J,a9 as K,y as M,I as P,at as Q,o as W,c as X,w as u,a as t,d as Y,j as _,B as v,u as n,C as f,av as y,aw as x,z as Z,g as ee}from"./index.2b059d96.js";import{r as C,m as ae,u as se}from"./index.esm.a100cd13.js";import{b as oe}from"./bussinesUnit.service.dfaa0c31.js";import{c as h}from"./categories.service.61f1472c.js";const te={class:"container mx-auto"},le={class:"grid md:grid-cols-3 gap-3"},ne={class:"grid md:grid-cols-2 gap-2"},re={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(I){const g=I,{t:d}=E(),w=H(),O=J(),R=K();let $=M([]);const V=[{id:1,label:d("message.category.statuses.active")},{id:0,label:d("message.category.statuses.inactive")},{id:2,label:d("message.category.statuses.deleted")}],s=M({_id:"",codigo:"00",nombre:"",siglas:"",unidadNegocio:$.value,estado:V[0]}),k=P(()=>({codigo:{required:C,maxLength:ae(3)},nombre:{required:C}})),p=se(k,s);Q(async()=>{var l;let a=await oe.allBussinesUnitGet();const e=(a==null?void 0:a.data.unidadesNegocio)||[];if($.value=e.map(o=>({id:o._id,label:o.nombre})),g.path==="update"){const o=await h.read(O.params);s.value=o.data,s.value.unidadNegocio=q((l=o.data)==null?void 0:l.unidadNegocio),s.value.estado=V.filter(r=>r.id===o.data.estado)[0]}});const q=a=>({id:a._id,label:a.nombre}),j=(a,e={})=>{console.log(a)},z=a=>{const{_id:e,codigo:l,nombre:o,siglas:r,unidadNegocio:c,estado:b}=a.value,m={_id:e,codigo:l,nombre:o,siglas:r,unidadNegocio:c.id,estado:b.id};return console.log(m),g.path==="create"?h.create(m):h.update(m)},A=g.path==="create"?d("message.category.created.success"):d("message.category.updated.success"),G=g.path==="create"?d("message.category.created.error"):d("message.category.updated.error"),T=async()=>{await p.value.$validate()?z(s).then(()=>{w.success(A),R.push("/setup/categories")}).catch(e=>{var l,o,r;if((o=(l=e.response)==null?void 0:l.data)!=null&&o.msg){w.error(`${G} ${e.response.data.msg}`);return}if((r=e.response.data)!=null&&r.errors){const c=e.response.data.errors;for(let b of c);}}):console.log("error")};return(a,e)=>(W(),X(ee,{isForm:"",onSubmit:Z(T,["prevent"])},{footer:u(()=>[t(Y,{label:a.$t(`message.${g.saveLabel}`),type:"submit",color:"success"},null,8,["label"])]),default:u(()=>{var l,o,r,c,b,m,N,U,B,S,L,F;return[_("div",null,[_("div",te,[_("div",le,[t(v,{label:a.$t("message.category.code"),help:(r=(o=(l=n(p))==null?void 0:l.codigo)==null?void 0:o.$errors[0])==null?void 0:r.$message},{default:u(()=>[t(f,{modelValue:s.value.codigo,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value.codigo=i),icon:n(y)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),t(v,{label:a.$t("message.category.name"),help:(m=(b=(c=n(p))==null?void 0:c.nombre)==null?void 0:b.$errors[0])==null?void 0:m.$message},{default:u(()=>[t(f,{modelValue:s.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=i=>s.value.nombre=i),icon:n(y)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),t(v,{label:a.$t("message.category.acronyms"),help:(B=(U=(N=n(p))==null?void 0:N.siglas)==null?void 0:U.$errors[0])==null?void 0:B.$message},{default:u(()=>[t(f,{modelValue:s.value.siglas,"onUpdate:modelValue":e[2]||(e[2]=i=>s.value.siglas=i),icon:n(y)},null,8,["modelValue","icon"])]),_:1},8,["label","help"])]),_("div",ne,[t(v,{label:a.$t("message.category.businessUnit")},{default:u(()=>[t(f,{modelValue:s.value.unidadNegocio,"onUpdate:modelValue":e[3]||(e[3]=i=>s.value.unidadNegocio=i),icon:n(x),options:n($),onOnSelectChange:j},null,8,["modelValue","icon","options"])]),_:1},8,["label"]),t(v,{label:a.$t("message.category.status"),help:(F=(L=(S=n(p))==null?void 0:S.estado)==null?void 0:L.$errors[0])==null?void 0:F.$message},{default:u(()=>[t(f,{modelValue:s.value.estado,"onUpdate:modelValue":e[4]||(e[4]=i=>s.value.estado=i),icon:n(x),options:V},null,8,["modelValue","icon"])]),_:1},8,["label","help"])])])])]}),_:1},8,["onSubmit"]))}},me=D(re,[["__scopeId","data-v-4154a0a2"]]);export{me as F};
