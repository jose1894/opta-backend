import{af as H,ag as J,as as K,a9 as Q,y as h,at as W,I as X,o as Y,c as Z,w as u,a as r,d as ee,j,B as b,u as l,C as f,au as se,aw as _,av as ae,z as te,g as oe}from"./index.94f69dfc.js";import{r as w,m as le,u as ie}from"./index.esm.8eaf8d5b.js";import{s as ne}from"./states.services.447377dd.js";import{c as S}from"./cities.service.6e8d35a5.js";import{c as re}from"./countries.service.e775474b.js";const de={class:"grid md:grid-cols-3 gap-4"},ue={class:"grid md:grid-cols-2 gap-4"},be={__name:"FormView",props:{path:"",saveLabel:"",state:{}},setup(q){const g=q,{t:c}=H(),B=J(),z=K(),A=Q();let y=[{id:1,label:c("message.city.statuses.active")},{id:0,label:c("message.city.statuses.inactive")},{id:2,label:c("message.city.statuses.deleted")}],$=h([]),V=h([]);const a=h({_id:"",codigo:"00",nombre:"",estado:y[0],pais:V.value,state:$.value}),D=e=>{const{_id:s,codigo:i,nombre:o,estado:n,pais:t,state:p}=e.value,v={_id:s,codigo:i,nombre:o,estado:n.id,pais:t.id,state:p.id};return g.path==="create"?S.create(v):S.update(v)};W(async()=>{var i,o,n;let e=await re.getDelete({estado:1});const s=(e==null?void 0:e.paises)||[];if(console.log(s),V.value=s.map(t=>({id:t._id,label:t.nombre})),g.path==="update"){const t=await S.read(z.params);(i=t.data)!=null&&i.state,a.value=t.data,a.value.estado=y.filter(p=>p.id===t.data.estado)[0],a.value.pais=L((o=t.data)==null?void 0:o.pais),C(a.value.pais,(n=t.data)==null?void 0:n.state)}});const L=e=>({id:e._id,label:e.nombre}),T=X(()=>({codigo:{required:w,maxLength:le(3)},nombre:{required:w},estado:{required:w}})),m=ie(T,a),C=(e,s={})=>{const{id:i}=e;$.value=[],x(i).then(o=>{const n=(o==null?void 0:o.estados)||[];$.value=n.map(t=>({id:t._id,label:t.nombre})),g.path==="update"&&(a.value.state=L(s))}).catch(o=>{console.log(o)})},x=async e=>await ne.estadosByPais(e),E=g.path==="create"?c("message.city.created.success"):c("message.city.updated.success"),G=async()=>{const e=await m.value.$validate();console.log(e),e?D(a).then(()=>{B.success(E),A.push("/setup/cities")}).catch(s=>{var i,o;if((i=s.response.data)!=null&&i.msg){B.error(`${c("message.city.created.error")} ${s.response.data.msg}`);return}if((o=s.response.data)!=null&&o.errors){const n=s.response.data.errors;for(let t of n);}}):console.log("error")};return(e,s)=>(Y(),Z(oe,{isForm:"",onSubmit:te(G,["prevent"])},{footer:u(()=>[r(ee,{label:e.$t(`message.${g.saveLabel}`),type:"submit",color:"success"},null,8,["label"])]),default:u(()=>{var i,o,n,t,p,v,U,M,O,R,k,F,I,N,P;return[j("div",de,[r(b,{label:e.$t("message.city.code"),help:(n=(o=(i=l(m))==null?void 0:i.codigo)==null?void 0:o.$errors[0])==null?void 0:n.$message},{default:u(()=>[r(f,{name:"codigo",modelValue:a.value.codigo,"onUpdate:modelValue":s[0]||(s[0]=d=>a.value.codigo=d),icon:l(se)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),r(b,{label:e.$t("message.city.country"),help:(v=(p=(t=l(m))==null?void 0:t.estado)==null?void 0:p.$errors[0])==null?void 0:v.$message},{default:u(()=>[r(f,{modelValue:a.value.pais,"onUpdate:modelValue":s[1]||(s[1]=d=>a.value.pais=d),icon:l(_),options:l(V),onOnSelectChange:C},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"]),r(b,{label:e.$t("message.city.state"),help:(O=(M=(U=l(m))==null?void 0:U.state)==null?void 0:M.$errors[0])==null?void 0:O.$message},{default:u(()=>[r(f,{modelValue:a.value.state,"onUpdate:modelValue":s[2]||(s[2]=d=>a.value.state=d),icon:l(_),options:l($)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"])]),j("div",ue,[r(b,{label:e.$t("message.city.name"),help:(F=(k=(R=l(m))==null?void 0:R.nombre)==null?void 0:k.$errors[0])==null?void 0:F.$message},{default:u(()=>[r(f,{modelValue:a.value.nombre,"onUpdate:modelValue":s[3]||(s[3]=d=>a.value.nombre=d),icon:l(ae)},null,8,["modelValue","icon"])]),_:1},8,["label","help"]),r(b,{label:e.$t("message.city.status"),help:(P=(N=(I=l(m))==null?void 0:I.estado)==null?void 0:N.$errors[0])==null?void 0:P.$message},{default:u(()=>[r(f,{modelValue:a.value.estado,"onUpdate:modelValue":s[4]||(s[4]=d=>a.value.estado=d),icon:l(_),options:l(y)},null,8,["modelValue","icon","options"])]),_:1},8,["label","help"])])]}),_:1},8,["onSubmit"]))}};export{be as _};
